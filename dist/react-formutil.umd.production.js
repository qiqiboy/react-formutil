(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("react"),require("react-dom")):typeof define==="function"&&define.amd?define(["exports","react","react-dom"],r):(e=typeof globalThis!=="undefined"?globalThis:e||self,r(e.ReactFormutil={},e.React,e.ReactDOM))})(this,(function(e,r,t){"use strict";function n(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var a=n(r);function i(e,r,t){if(r in e){Object.defineProperty(e,r,{value:t,enumerable:true,configurable:true,writable:true})}else{e[r]=t}return e}var o=i;function u(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(r)n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}));t.push.apply(t,n)}return t}function s(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};if(r%2){u(Object(t),true).forEach((function(r){o(e,r,t[r])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{u(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}}return e}var f=s;function l(e,r){if(r==null||r>e.length)r=e.length;for(var t=0,n=new Array(r);t<r;t++){n[t]=e[t]}return n}var c=l;function $(e){if(Array.isArray(e))return c(e)}var d=$;function v(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}var p=v;function h(e,r){if(!e)return;if(typeof e==="string")return c(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor)t=e.constructor.name;if(t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,r)}var m=h;function y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var g=y;function b(e){return d(e)||p(e)||m(e)||g()}var w=b;function S(e){if(Array.isArray(e))return e}var C=S;function P(e,r){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(e)))return;var t=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){t.push(u.value);if(r&&t.length===r)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return t}var F=P;function V(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var O=V;function k(e,r){return C(e)||F(e,r)||m(e,r)||O()}var E=k;function _(e,r){if(!(e instanceof r)){throw new TypeError("Cannot call a class as a function")}}var j=_;function x(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function R(e,r,t){if(r)x(e.prototype,r);if(t)x(e,t);return e}var A=R;function D(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var N=D;function U(e,r){return r={exports:{}},e(r,r.exports),r.exports}var M=U((function(e){function r(t,n){e.exports=r=Object.setPrototypeOf||function e(r,t){r.__proto__=t;return r};return r(t,n)}e.exports=r}));function T(e,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:true,configurable:true}});if(r)M(e,r)}var I=T;var L=U((function(e){function r(t){e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function e(r){return r.__proto__||Object.getPrototypeOf(r)};return r(t)}e.exports=r}));function H(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}var z=H;var B=U((function(e){function r(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=r=function e(r){return typeof r}}else{e.exports=r=function e(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return r(t)}e.exports=r}));function Q(e,r){if(r&&(B(r)==="object"||typeof r==="function")){return r}return N(e)}var q=Q;function G(e){var r=z();return function t(){var n=L(e),a;if(r){var i=L(this).constructor;a=Reflect.construct(n,arguments,i)}else{a=n.apply(this,arguments)}return q(this,a)}}var K=G;var Y=function(){};var W=Y;var J=r.createContext((function(){return{}}));var X=60103,Z=60106,ee=60107,re=60108,te=60114,ne=60109,ae=60110,ie=60112,oe=60113,ue=60120,se=60115,fe=60116,le=60121,ce=60122,$e=60117,de=60129,ve=60131;if("function"===typeof Symbol&&Symbol.for){var pe=Symbol.for;X=pe("react.element");Z=pe("react.portal");ee=pe("react.fragment");re=pe("react.strict_mode");te=pe("react.profiler");ne=pe("react.provider");ae=pe("react.context");ie=pe("react.forward_ref");oe=pe("react.suspense");ue=pe("react.suspense_list");se=pe("react.memo");fe=pe("react.lazy");le=pe("react.block");ce=pe("react.server.block");$e=pe("react.fundamental");de=pe("react.debug_trace_mode");ve=pe("react.legacy_hidden")}function he(e){if("object"===typeof e&&null!==e){var r=e.$$typeof;switch(r){case X:switch(e=e.type,e){case ee:case te:case re:case oe:case ue:return e;default:switch(e=e&&e.$$typeof,e){case ae:case ie:case fe:case se:case ne:return e;default:return r}}case Z:return r}}}var me=ne,ye=X,ge=ie,be=ee,we=fe,Se=se,Ce=Z,Pe=te,Fe=re,Ve=oe;var Oe=ae;var ke=me;var Ee=ye;var _e=ge;var je=be;var xe=we;var Re=Se;var Ae=Ce;var De=Pe;var Ne=Fe;var Ue=Ve;var Me=function(){return!1};var Te=function(){return!1};var Ie=function(e){return he(e)===ae};var Le=function(e){return he(e)===ne};var He=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===X};var ze=function(e){return he(e)===ie};var Be=function(e){return he(e)===ee};var Qe=function(e){return he(e)===fe};var qe=function(e){return he(e)===se};var Ge=function(e){return he(e)===Z};var Ke=function(e){return he(e)===te};var Ye=function(e){return he(e)===re};var We=function(e){return he(e)===oe};var Je=function(e){return"string"===typeof e||"function"===typeof e||e===ee||e===te||e===de||e===re||e===oe||e===ue||e===ve||"object"===typeof e&&null!==e&&(e.$$typeof===fe||e.$$typeof===se||e.$$typeof===ne||e.$$typeof===ae||e.$$typeof===ie||e.$$typeof===$e||e.$$typeof===le||e[0]===ce)?!0:!1};var Xe=he;var Ze={ContextConsumer:Oe,ContextProvider:ke,Element:Ee,ForwardRef:_e,Fragment:je,Lazy:xe,Memo:Re,Portal:Ae,Profiler:De,StrictMode:Ne,Suspense:Ue,isAsyncMode:Me,isConcurrentMode:Te,isContextConsumer:Ie,isContextProvider:Le,isElement:He,isForwardRef:ze,isFragment:Be,isLazy:Qe,isMemo:qe,isPortal:Ge,isProfiler:Ke,isStrictMode:Ye,isSuspense:We,isValidElementType:Je,typeOf:Xe};var er=U((function(e){{e.exports=Ze}}));var rr=er.isValidElementType;var tr=Object.getPrototypeOf({});var nr=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g;var ar=typeof window==="undefined"?global:window;function ir(e){return typeof e==="undefined"}function or(e){return typeof e==="function"}function ur(e){return ir(e)||e===null||e+""===""}function sr(e){return!!e&&or(e.then)}function fr(e){return Object.prototype.toString.call(e)==="[object Object]"}function lr(e){if(!fr(e))return false;if(null===Object.getPrototypeOf(e))return true;if(!or(e.constructor))return false;return e.constructor.prototype===tr}function cr(e){return rr(e)&&typeof e!=="string"}function $r(e){if(Array.isArray(e)){var r=[];for(var t=0,n=e.length;t<n;t++){r[t]=$r(e[t])}return r}else if(lr(e)){var a={};for(var i in e){if(e.hasOwnProperty(i))a[i]=$r(e[i])}return a}return e}var dr=function e(r){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++){n[a-1]=arguments[a]}if(or(r)){r.apply(void 0,n)}return n[0]};function vr(e){return function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++){t[n]=arguments[n]}if(cr(t[0])){return e.apply(void 0,t)}return function(r){return e(r,t[0])}}}var pr=["minlength","maxlength","max","min","required","pattern","step"];function hr(e){return pr.indexOf(e.toLowerCase())>-1}var mr=function e(r){try{var t=new Function("origin","global","return typeof ".concat(r," === 'number' || (typeof ").concat(r," !== 'undefined' && !(origin in global)) ? ").concat(r," : origin"));return t(r,ar)}catch(e){return r}};function yr(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++){r[t]=arguments[t]}var n=r[0],a=r[1],i=r[2];W(typeof a==="string","The second parameter(".concat(JSON.stringify(a),") of parsePath() must be a string."));var o=(a.match(nr)||[]).map((function(e){return e.replace(/\s/g,"")}));var u=a.split(nr).map((function(e){return e.trim()})).filter((function(e){return e!==""}));var s=n;try{if(r.length<3){for(var l=0,c=u.length;l<c;l++){var $=mr(u[l]);if(l+1===c){return s[$]}if(ir(s[$])){break}s=s[$]}}else{for(var d=0,v=u.length;d<v;d++){var p=mr(u[d]);var h=u[d+1];var m=o[d];if(ir(h)){s[p]=i;break}switch(m){case"].":case".":s=s[p]=ir(s[p])?{}:f({},s[p]);break;case"][":case"[":var y=mr(h);s=s[p]=ir(s[p])?typeof y==="number"&&y>=0?[]:{}:Array.isArray(s[p])?w(s[p]):f({},s[p]);break;default:s[p]=i;break}}}}catch(e){}if(r.length>2){return n}}function gr(e,r){var t=r.split(nr).map((function(e){return e.trim()})).filter((function(e){return e!==""}));for(var n=0,a=t.length;n<a;n++){var i=mr(t[n]);if(!(i in e)){break}if(n+1===a){return{data:e[i]}}e=e[i]}}function br(e,r){if(e){if(or(e)){e(r)}else if("current"in e){e.current=r}}}var wr=function e(r,t){for(var n=0,a=r.length;n<a;n++){if(t(r[n])===true){return r[n]}}};var Sr=function e(r,t){return Object.keys(r).reduce((function(e,n){e[n]=t(r[n],n,r);return e}),{})};var Cr=function e(r,t){return Object.keys(r).forEach((function(e){return t(r[e],e,r)}))};var Pr=undefined;function Fr(e,r,t){Cr(e,(function(r,t){if(r===Pr){delete e[t]}else if(lr(r)||Array.isArray(r)){Fr(r,t,e)}}));if(t&&Object.keys(e).every((function(r){return e[r]===Pr}))){t[r]=Pr;Fr(t)}}var Vr=function e(r,t){if(!ir(yr(r,t))){yr(r,t,Pr);Fr(r)}};function Or(e,r){if(e===r){return true}var t=Object.keys(e);if(t.length!==Object.keys(r).length){return false}for(var n=0;n<t.length;n++){if(e[t[n]]!==r[t[n]]){return false}}return true}var kr="FORM_VALIDATE_RESULT";var Er,_r;if(typeof requestAnimationFrame==="function"){Er=requestAnimationFrame;_r=cancelAnimationFrame}else{Er=setTimeout;_r=clearTimeout}var jr=function(e){I(i,e);var n=K(i);function i(e){var r;j(this,i);r=n.call(this,e);r.$$formPending=void 0;r.$$formValidatePromise=void 0;r.$$registers={};r.$$deepRegisters={};r.getFormContext=function(){return{$$registers:r.$$registers,$$register:r.$$register,$$unregister:r.$$unregister,$$onChange:r.$$onChange,$$getDefault:r.$$getDefault,$formutil:r.$formutil}};r.$$regDuplications={};r.$$duplicateTimer=void 0;r.$$checkDuplication=function(){var e=N(r),t=e.$$regDuplications;var n;Cr(t,(function(e,r){var a=E(e,2),i=a[0],o=a[1];W(i.$$reserved);o.$$reset(i.$getState());n=delete t[r]}));if(n){r.$render()}};r.$$register=function(e,n,a){r.$$unregister(a,n);if(e){var i=r.$$getRegister(e);if(i){_r(r.$$duplicateTimer);r.$$regDuplications[e]=[i,n];r.$$duplicateTimer=Er((function(){return t.unstable_batchedUpdates(r.$$checkDuplication)}))}else{r.$$fieldChangedQueue.push({name:e,$newValue:n.$getState().$value});Vr(r.$$defaultValues,e)}r.$$registers[n.$name=e]=n;r.$$formShouldUpdateFields[e]=true;r.createDeepRegisters();r.$render()}};r.$$unregister=function(e,t,n){if(e){if(e in r.$$regDuplications){var a=E(r.$$regDuplications[e],2),i=a[0],o=a[1];r.$$fieldChangedQueue.push({name:e,$newValue:o.$getState().$value,$prevValue:i.$getState().$value});delete r.$$regDuplications[e]}else if(r.$$registers[e]===t){if(n){t.$$reserved=true}else{delete r.$$registers[e];r.$$fieldChangedQueue.push({name:e,$prevValue:t.$getState().$value});Vr(r.$$defaultValues,e)}}r.$$formShouldUpdateAll=true;r.createDeepRegisters();r.$render()}};r.$$defaultInitialize=function(){var e=r.props,t=e.$defaultValues,n=e.$defaultStates;r.$$defaultValues=r.$$deepParseObject($r(or(t)?t(r.props)||{}:t));r.$$defaultStates=r.$$deepParseObject($r(or(n)?n(r.props)||{}:n))};r.$$getDefault=function(){return{$$defaultStates:r.$$defaultStates,$$defaultValues:r.$$defaultValues}};r.$$formShouldUpdateFields={};r.$$formShouldUpdateAll=false;r.$$fieldChangedQueue=[];r.$$triggerFormChange=function(){if(r.$$fieldChangedQueue.length){var e=w(r.$$fieldChangedQueue);r.$$fieldChangedQueue.length=0;var t={};var n={};var a=r.$$registers;var i=false;e.forEach((function(e){if(!(e.name in a)){delete e.$newValue}if(e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var o=r.$$getRegister(e.name);if(o){o.$$triggerChange(e)}}"$newValue"in e&&yr(t,e.name,e.$newValue);!e.$dirty&&"$prevValue"in e&&yr(n,e.name,e.$prevValue);i=true}}));if(i){if(or(r.props.$validator)){r.$$formValidate()}if(or(r.props.$onFormChange)){r.props.$onFormChange(r.$formutil,t,n)}}}};r.createDeepRegisters=function(){return r.$$deepRegisters=r.$$deepParseObject(r.$$registers)};r.$$getRegister=function(e){if(e){var t=r.$$registers[e]||yr(r.$$deepRegisters,e);if(t){return t}}};r.$$formValidate=function(){return r.$$formValidatePromise=new Promise((function(e){var t=r.props.$validator;var n;var a;var i;var o;var u=t(r.$formutil.$params,r.$formutil);var s=function r(t){return e(dr(i,t))};if(sr(u)){if(!r.$$formPending){r.$$formPending=true;r.$render()}a=function e(r){return n=r(s)};o=u.then((function(){return void 0}),(function(e){return e})).then((function(e){if(n){return n}r.$shouldCancelPrevAsyncValidate=null;r.$$formPending=false;return r.$$setFormErrors(e,s)}))}else{if(r.$$formPending){r.$$formPending=false}o=r.$$setFormErrors(u,s)}if(r.$shouldCancelPrevAsyncValidate){r.$shouldCancelPrevAsyncValidate((function(e){i=e;return o}))}r.$shouldCancelPrevAsyncValidate=a}))};r.$$setFormErrors=function(e,t){if(e&&(e instanceof Error||typeof e!=="object")){return r.$render(t)}return r.$$setStates(e||{},(function(e,r){var t=r.$getState(),n=t.$error,a=n===void 0?{}:n;if(e){return{$error:f(f({},a),{},o({},kr,e))}}if(a[kr]){delete a[kr];return{$error:a}}}),t,true)};r.$getField=function(e){var t=r.$$getRegister(e);if(t){var n;return(n=t.$new)===null||n===void 0?void 0:n.call(t)}};r.$$onChange=function(e,t,n){return r.$setStates(o({},e,t),n)};r.$$setStates=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments.length>1?arguments[1]:undefined;var a=arguments.length>2?arguments[2]:undefined;var i=arguments.length>3?arguments[3]:undefined;var o=r.$$deepParseObject(e);var u=[];Cr(r.$$registers,(function(e,t){var a=gr(o,t);if(i||a){var s=e.$getState();var f=n(a&&a.data,e);if(f){var l=e.$$merge(f),c=l.$value;u.push([e,f]);if("$value"in f||"$viewValue"in f){var $=wr(r.$$fieldChangedQueue,(function(e){return e.name===t}));if($){if(!("$prevValue"in $)){$.$dirty=true;$.$prevValue=$.$newValue}$.$newValue=c}else{r.$$fieldChangedQueue.push({name:t,$newValue:c,$prevValue:s.$value})}}r.$$formShouldUpdateFields[t]=true}}}));return t.unstable_batchedUpdates((function(){u.forEach((function(e){var r=E(e,2),t=r[0],n=r[1];return t.$$detectChange(n)}));return r.$render(a)}))};r.$render=function(e){return new Promise((function(t){return r.forceUpdate((function(){return t(dr(e,r.$formutil))}))}))};r.$validates=function(){var e;for(var t=arguments.length,n=new Array(t),a=0;a<t;a++){n[a]=arguments[a]}if(or(n[n.length-1])){e=n.pop()}if(n.length){var i=function e(t){t.forEach((function(t){if(Array.isArray(t)){e(t)}else{var n=r.$getField(t);if(n){n.$validate()}}}))};i(n)}else{Cr(r.$$registers,(function(e){return e.$validate()}));if(or(r.props.$validator)){r.$$formValidate()}}return r.$onValidates(e)};r.$onValidates=function(e){var t=Object.keys(r.$$registers).map((function(e){return r.$$registers[e].$onValidate()}));t.push(r.$$formValidatePromise);return Promise.all(t).then((function(){return dr(e,r.$formutil)}))};r.$validate=function(e,t){var n=r.$getField(e);if(n){return n.$validate(t)}return dr(t)};r.$reset=function(e,t){r.$$defaultInitialize();if(or(e)){t=e;e={}}return r.$$setStates(e,(function(e,r){return r.$$reset(e)}),t,true)};r.$setStates=function(e,t){return r.$$setStates(e,(function(e){return e}),t)};r.$setValues=function(e,t){r.$$deepParseObject($r(e),r.$$defaultValues);Fr(r.$$defaultValues);return r.$$setStates(e,(function(e){return{$value:e}}),t)};r.$setFocuses=function(e,t){return r.$$setStates(e,(function(e){return{$focused:e}}),t)};r.$setDirts=function(e,t){return r.$$setStates(e,(function(e){return{$dirty:e}}),t)};r.$setTouches=function(e,t){return r.$$setStates(e,(function(e){return{$touched:e}}),t)};r.$setPendings=function(e,t){return r.$$setStates(e,(function(e){return{$pending:e}}),t)};r.$setErrors=function(e,t){return r.$$setStates(e,(function(e){return{$error:e}}),t)};r.$batchState=function(e,t){return r.$setStates(Sr(r.$$registers,(function(){return e})),t)};r.$batchDirty=function(e,t){return r.$batchState({$dirty:e},t)};r.$batchTouched=function(e,t){return r.$batchState({$touched:e},t)};r.$batchFocused=function(e,t){return r.$batchState({$focused:e},t)};r.$batchPending=function(e,t){return r.$batchState({$pending:e},t)};r.$batchError=function(e,t){return r.$batchState({$error:e},t)};r.$getFirstError=function(e){var t=r.$formutil;if(e){var n=t.$getField(e);return n&&n.$getFirstError()}for(var a in t.$weakErrors){if(t.$weakErrors.hasOwnProperty(a)){var i=t.$weakErrors[a];for(var o in i){if(i.hasOwnProperty(o)){return i[o]instanceof Error?i[o].message:i[o]}}}}};r.$new=function(){return r.$formutil};r.$$defaultInitialize();return r}A(i,[{key:"$$deepParseObject",value:function e(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Cr(r,(function(e,r){return yr(t,r,e)}));return t}},{key:"$$resetFormUpdateFields",value:function e(){this.$$formShouldUpdateFields={};this.$$formShouldUpdateAll=false}},{key:"componentDidMount",value:function e(){br(this.props.$ref,this.$formutil)}},{key:"componentDidUpdate",value:function e(r){br(this.props.$ref,this.$formutil);this.$$triggerFormChange()}},{key:"componentWillUnmount",value:function e(){br(this.props.$ref,null)}},{key:"_render",value:function e(){var t=this.$formutil;var n=this.props,a=n.children,i=n.render,o=n.component;if(o){return r.createElement(o,{$formutil:t})}if(or(i)){return i(t)}if(or(a)){return a(t)}return r.Children.map(a,(function(e){return e&&cr(e.type)?r.cloneElement(e,{$formutil:t}):e}))}},{key:"render",value:function e(){var r=this;var t=this.props.$processer;var n=Object.keys(this.$$registers).map((function(e){return{path:e,$state:r.$$registers[e].$getState()}}));var i=this.$$formShouldUpdateAll;var o=this.$formutil||{};var u=n.some((function(e){var r=e.$state;return r.$invalid}));var s=n.some((function(e){var r=e.$state;return r.$dirty}));var l=n.some((function(e){var r=e.$state;return r.$touched}));var c=n.some((function(e){var r=e.$state;return r.$focused}));var $=this.$$formPending||n.some((function(e){var r=e.$state;return r.$pending}));var d=i?{}:f({},o.$pureParams);var v=i?{}:f({},o.$states);var p=i?{}:f({},o.$errors);var h=i?{}:f({},o.$dirts);var m=i?{}:f({},o.$touches);var y=i?{}:f({},o.$focuses);var g=i?{}:f({},o.$pendings);var b=i?{}:f({},o.$weakStates);var w=i?{}:f({},o.$weakParams);var S=i?{}:f({},o.$weakErrors);var C=i?{}:f({},o.$weakDirts);var P=i?{}:f({},o.$weakFocuses);var F=i?{}:f({},o.$weakTouches);var V=i?{}:f({},o.$weakPendings);for(var O=0,k=n.length;O<k;O++){var E=n[O],_=E.$state,j=E.path;if(!i){if(!this.$$formShouldUpdateFields[j]){continue}}if(t){t(_,j)}if(j in w&&_.$pristine&&ir(_.$value)){delete w[j];Vr(d,j)}else if(w[j]!==_.$value){w[j]=_.$value;yr(d,j,_.$value)}yr(v,j,_);b[j]=_;if(S[j]!==_.$error){if(_.$invalid){yr(p,j,_.$error);S[j]=_.$error}else if(j in S){Vr(p,j);delete S[j]}}if(C[j]!==_.$dirty){yr(h,j,_.$dirty);C[j]=_.$dirty}if(F[j]!==_.$touched){yr(m,j,_.$touched);F[j]=_.$touched}if(P[j]!==_.$focused){yr(y,j,_.$focused);P[j]=_.$focused}if(V[j]!==_.$pending){yr(g,j,_.$pending);V[j]=_.$pending}}this.$formutil={$$registers:f({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:v,$pureParams:d,$params:f(f({},this.$$defaultValues),d),$errors:p,$dirts:h,$touches:m,$focuses:y,$pendings:g,$weakStates:b,$weakParams:w,$weakErrors:S,$weakDirts:C,$weakTouches:F,$weakFocuses:P,$weakPendings:V,$getFirstError:this.$getFirstError,$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:this.$new,$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$setPendings:this.$setPendings,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$batchPending:this.$batchPending,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!u,$invalid:u,$dirty:s,$pristine:!s,$touched:l,$untouched:!l,$focused:c,$pending:$};this.$$resetFormUpdateFields();return a["default"].createElement(J.Provider,{value:this.getFormContext},this._render())}}]);return i}(r.Component);jr.displayName="React.Formutil.Form";jr.defaultProps={$defaultValues:{},$defaultStates:{}};function xr(e,r){if(e==null)return{};var t={};var n=Object.keys(e);var a,i;for(i=0;i<n.length;i++){a=n[i];if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}var Rr=xr;function Ar(e,r){if(e==null)return{};var t=Rr(e,r);var n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++){n=i[a];if(r.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;t[n]=e[n]}}return t}var Dr=Ar;var Nr="function"===typeof Symbol&&Symbol.for,Ur=Nr?Symbol.for("react.element"):60103,Mr=Nr?Symbol.for("react.portal"):60106,Tr=Nr?Symbol.for("react.fragment"):60107,Ir=Nr?Symbol.for("react.strict_mode"):60108,Lr=Nr?Symbol.for("react.profiler"):60114,Hr=Nr?Symbol.for("react.provider"):60109,zr=Nr?Symbol.for("react.context"):60110,Br=Nr?Symbol.for("react.async_mode"):60111,Qr=Nr?Symbol.for("react.concurrent_mode"):60111,qr=Nr?Symbol.for("react.forward_ref"):60112,Gr=Nr?Symbol.for("react.suspense"):60113,Kr=Nr?Symbol.for("react.suspense_list"):60120,Yr=Nr?Symbol.for("react.memo"):60115,Wr=Nr?Symbol.for("react.lazy"):60116,Jr=Nr?Symbol.for("react.block"):60121,Xr=Nr?Symbol.for("react.fundamental"):60117,Zr=Nr?Symbol.for("react.responder"):60118,et=Nr?Symbol.for("react.scope"):60119;function rt(e){if("object"===typeof e&&null!==e){var r=e.$$typeof;switch(r){case Ur:switch(e=e.type,e){case Br:case Qr:case Tr:case Lr:case Ir:case Gr:return e;default:switch(e=e&&e.$$typeof,e){case zr:case qr:case Wr:case Yr:case Hr:return e;default:return r}}case Mr:return r}}}function tt(e){return rt(e)===Qr}var nt=Br;var at=Qr;var it=zr;var ot=Hr;var ut=Ur;var st=qr;var ft=Tr;var lt=Wr;var ct=Yr;var $t=Mr;var dt=Lr;var vt=Ir;var pt=Gr;var ht=function(e){return tt(e)||rt(e)===Br};var mt=tt;var yt=function(e){return rt(e)===zr};var gt=function(e){return rt(e)===Hr};var bt=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===Ur};var wt=function(e){return rt(e)===qr};var St=function(e){return rt(e)===Tr};var Ct=function(e){return rt(e)===Wr};var Pt=function(e){return rt(e)===Yr};var Ft=function(e){return rt(e)===Mr};var Vt=function(e){return rt(e)===Lr};var Ot=function(e){return rt(e)===Ir};var kt=function(e){return rt(e)===Gr};var Et=function(e){return"string"===typeof e||"function"===typeof e||e===Tr||e===Qr||e===Lr||e===Ir||e===Gr||e===Kr||"object"===typeof e&&null!==e&&(e.$$typeof===Wr||e.$$typeof===Yr||e.$$typeof===Hr||e.$$typeof===zr||e.$$typeof===qr||e.$$typeof===Xr||e.$$typeof===Zr||e.$$typeof===et||e.$$typeof===Jr)};var _t=rt;var jt={AsyncMode:nt,ConcurrentMode:at,ContextConsumer:it,ContextProvider:ot,Element:ut,ForwardRef:st,Fragment:ft,Lazy:lt,Memo:ct,Portal:$t,Profiler:dt,StrictMode:vt,Suspense:pt,isAsyncMode:ht,isConcurrentMode:mt,isContextConsumer:yt,isContextProvider:gt,isElement:bt,isForwardRef:wt,isFragment:St,isLazy:Ct,isMemo:Pt,isPortal:Ft,isProfiler:Vt,isStrictMode:Ot,isSuspense:kt,isValidElementType:Et,typeOf:_t};var xt=U((function(e){{e.exports=jt}}));var Rt={childContextTypes:true,contextType:true,contextTypes:true,defaultProps:true,displayName:true,getDefaultProps:true,getDerivedStateFromError:true,getDerivedStateFromProps:true,mixins:true,propTypes:true,type:true};var At={name:true,length:true,prototype:true,caller:true,callee:true,arguments:true,arity:true};var Dt={$$typeof:true,render:true,defaultProps:true,displayName:true,propTypes:true};var Nt={$$typeof:true,compare:true,defaultProps:true,displayName:true,propTypes:true,type:true};var Ut={};Ut[xt.ForwardRef]=Dt;Ut[xt.Memo]=Nt;function Mt(e){if(xt.isMemo(e)){return Nt}return Ut[e["$$typeof"]]||Rt}var Tt=Object.defineProperty;var It=Object.getOwnPropertyNames;var Lt=Object.getOwnPropertySymbols;var Ht=Object.getOwnPropertyDescriptor;var zt=Object.getPrototypeOf;var Bt=Object.prototype;function Qt(e,r,t){if(typeof r!=="string"){if(Bt){var n=zt(r);if(n&&n!==Bt){Qt(e,n,t)}}var a=It(r);if(Lt){a=a.concat(Lt(r))}var i=Mt(e);var o=Mt(r);for(var u=0;u<a.length;++u){var s=a[u];if(!At[s]&&!(t&&t[s])&&!(o&&o[s])&&!(i&&i[s])){var f=Ht(r,s);try{Tt(e,s,f)}catch(e){}}}}return e}var qt=Qt;var Gt=["render","component","children","$defaultValues","$defaultStates","$onFormChange","$validator","$processer","$ref"];function Kt(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=function(r){I(i,r);var n=K(i);function i(){var r;j(this,i);for(var t=arguments.length,o=new Array(t),u=0;u<t;u++){o[u]=arguments[u]}r=n.call.apply(n,[this].concat(o));r.renderChildren=function(t){return a["default"].createElement(e,Object.assign({},r.othersProps,{$formutil:t,ref:r.props.__forwardRef__}))};return r}A(i,[{key:"render",value:function e(){var r=this.props,n=r.__forwardRef__,i=Dr(r,["__forwardRef__"]);var o=this.props,u=o.component,s=Dr(o,["component"]);Gt.forEach((function(e){if(e in i){if(e==="$defaultStates"||e==="$defaultValues"){s[e]=f(f({},t[e]),i[e])}delete i[e]}}));this.othersProps=i;return a["default"].createElement(jr,Object.assign({},t,s,{render:this.renderChildren}))}}]);return i}(r.Component);n.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous");var i=r.forwardRef((function(e,r){return a["default"].createElement(n,Object.assign({__forwardRef__:r},e))}));i.displayName="React.Formutil.withForm.ForwardRef."+(e.displayName||e.name||"Anonymous");return qt(i,e)}var Yt=vr(Kt);var Wt=typeof Element!=="undefined";var Jt=typeof Map==="function";var Xt=typeof Set==="function";var Zt=typeof ArrayBuffer==="function"&&!!ArrayBuffer.isView;function en(e,r){if(e===r)return true;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return false;var t,n,a;if(Array.isArray(e)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(!en(e[n],r[n]))return false;return true}var i;if(Jt&&e instanceof Map&&r instanceof Map){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;i=e.entries();while(!(n=i.next()).done)if(!en(n.value[1],r.get(n.value[0])))return false;return true}if(Xt&&e instanceof Set&&r instanceof Set){if(e.size!==r.size)return false;i=e.entries();while(!(n=i.next()).done)if(!r.has(n.value[0]))return false;return true}if(Zt&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){t=e.length;if(t!=r.length)return false;for(n=t;n--!==0;)if(e[n]!==r[n])return false;return true}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();a=Object.keys(e);t=a.length;if(t!==Object.keys(r).length)return false;for(n=t;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return false;if(Wt&&e instanceof Element)return false;for(n=t;n--!==0;){if((a[n]==="_owner"||a[n]==="__v"||a[n]==="__o")&&e.$$typeof){continue}if(!en(e[a[n]],r[a[n]]))return false}return true}return e!==e&&r!==r}var rn=function e(r,t){try{return en(r,t)}catch(e){if((e.message||"").match(/stack|recursion/i)){console.warn("react-fast-compare cannot handle circular refs");return false}throw e}};var tn=0;var nn={$valid:true,$invalid:false,$dirty:false,$pristine:true,$touched:false,$untouched:true,$focused:false,$pending:false,$error:{}};function an(e){return e!==true}function on(e,r,t){}var un="React.Formutil.Field";function sn(){return tn++}function fn(e,t){var n=t.children,a=t.render,i=t.component;if(i){return r.createElement(i,{$fieldutil:e})}if(or(a)){return a(e)}if(or(n)){return n(e)}return r.Children.map(n,(function(t){return t&&cr(t.type)?r.cloneElement(t,{$fieldutil:e}):t}))}function ln(e,r){var t={$$FIELD_UUID:e.$$FIELD_UUID,$$reset:u,$$merge:b,$$detectChange:a,$$triggerChange:i,$onValidate:o,$new:function r(){return e.$fieldutil},$picker:s,$getState:s,$getComponent:function e(){return r},$reset:function r(t,n){return e.$setState(u(t),n)},$getFirstError:g,$validate:l,$setState:e.$setState,$render:c,$setValue:$,$setTouched:d,$setDirty:v,$setFocused:p,$setValidity:m,$setError:h,$setPending:y};var n;function a(e){if("$value"in e||"$viewValue"in e){l()}}function i(r){var t=r.$newValue,n=r.$prevValue;var a=e.props.$onFieldChange;if(or(a)){a(t,n,e.$formContext.$formutil)}}function o(e){n.then(e);return n}function u(r){var t;var n=e.props,a=e.$formContext;if(a.$$getDefault){var i=n.name;var o=a.$$getDefault(),u=o.$$defaultStates,s=o.$$defaultValues;if(i&&s){var l=yr(s,i);t=yr(u,i)||{};if(!ir(l)){t.$value=l}}}var c=n.$defaultValue,$=n.$defaultState;return b(f(f(f(f({},nn),or($)?$(n):$),{},{$value:or(c)?c(n):"$defaultValue"in n?c:""},t),r))}function s(){return f({},e.$state)}function l(r){return n=new Promise((function(t){var n=e.props,a=e.$formContext;var i=f(f({},n.$validators),n.$asyncValidators);var o=e.$state,u=o.$value,s=o.$pending,l=Object.assign({},o.$error);var c=a.$formutil;var $={};var d=false;var v;var p;var g;var b;delete l[kr];var w=Object.keys(i).reduce((function(r,t){delete l[t];if(!d&&n[t]!=null){var a=i[t](u,n[t],f(f({},n),{},{$formutil:c,$fieldutil:e.$fieldutil,$validError:$}));if(sr(a)){r.push(a.catch((function(e){if(!v){m(t,e||t)}})))}else if(an(a)){$[t]=a||t;on(a,t,n.name);if(n.$validateLazy){d=true}}}return r}),[]);var S=function e(n){return t(dr(r,dr(g,n)))};if(w.length){if(!s){y(true)}p=function e(r){return v=r(S)};w.push(h(f(f({},l),$)));b=Promise.all(w).then((function(){if(v){return v}e.$shouldCancelPrevAsyncValidate=null;return y(false,S)}))}else{if(s){y(false)}b=h(f(f({},l),$),S)}if(e.$shouldCancelPrevAsyncValidate){e.$shouldCancelPrevAsyncValidate((function(e){g=e;return b}))}e.$shouldCancelPrevAsyncValidate=p}))}function c(r,t){return e.$setState({$viewValue:r,$dirty:true},t)}function $(r,t){return e.$setState({$value:r},t)}function d(r,t){return e.$setState({$touched:r},t)}function v(r,t){return e.$setState({$dirty:r},t)}function p(r,t){return e.$setState({$focused:r},t)}function h(r,t){return e.$setState({$error:r},t)}function m(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2?arguments[2]:undefined;var a=Object.assign({},e.$state.$error);if(an(t)){a[r]=t||r;on(t,r,e.props.name)}else{delete a[r]}return h(a,n)}function y(r,t){return e.$setState({$pending:r},t)}function g(){var r=e.$state.$error,t=r===void 0?{}:r;for(var n in t){if(t.hasOwnProperty(n)){return t[n]instanceof Error?t[n].message:t[n]}}}function b(r){var t=Object.assign({},r);if("$error"in t){if(!t.$error){t.$error={}}t.$valid=Object.keys(t.$error).length===0}var n=e.props,a=n.$parser,i=n.$formatter;if("$viewValue"in t&&!("$value"in t)){var o=function e(r){return t.$viewValue=r};t.$value=a?a(t.$viewValue,o):t.$viewValue}else if("$value"in t&&!("$viewValue"in t)){var u=function e(r){return t.$value=r};t.$viewValue=i?i(t.$value,u):t.$value}if("$valid"in t){t.$invalid=!t.$valid}else if("$invalid"in t){t.$valid=!t.$invalid}if("$dirty"in t){t.$pristine=!t.$dirty}else if("$pristine"in t){t.$dirty=!t.$pristine}if("$touched"in t){t.$untouched=!t.$touched}else if("$untouched"in t){t.$touched=!t.$untouched}e.$state=f(f({},e.$state),t);return s()}return t}var cn=function(e){I(t,e);var r=K(t);function t(){var e;j(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}e=r.call.apply(r,[this].concat(a));e.$$FIELD_UUID=sn();e.$formContext=void 0;e.$state=void 0;e.shouldRendered=false;e.$setState=function(r,t){return new Promise((function(n){var a=function r(){return n(dr(t,e.$fieldutil))};if(e.isMounting){var i=e.props.name;if(i in(e.$formContext.$$registers||{})){e.shouldRendered=false;e.$formContext.$$onChange(i,r,a);if(!e.shouldRendered){e.forceUpdate()}}else{e.$registered.$$merge(r);e.$registered.$$detectChange(r);e.forceUpdate(a)}}else{e.$registered.$$merge(r);a()}}))};return e}A(t,[{key:"componentDidMount",value:function e(){this.isMounting=true;var r=this.props.name,t=this.$formContext;W(!r||t.$formutil);if(t.$$register){t.$$register(r,this.$fieldHandler)}this.$prevState=this.$state;br(this.props.$ref,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){if(this.$formContext.$$unregister){this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount)}this.isMounting=false;br(this.props.$ref,null)}},{key:"componentDidUpdate",value:function e(r){var t=this.props.name;if(t!==r.name){if(this.$formContext.$$register){this.$formContext.$$register(t,this.$fieldHandler,r.name)}}br(this.props.$ref,this.$fieldutil);if(this.$state.$value!==this.$prevState.$value){if(!(t in(this.$formContext.$$registers||{}))){this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevState.$value})}}this.$prevState=this.$state}},{key:"shouldComponentUpdate",value:function e(r){var t=r.$memo;return!t||!Or(this.$registered.$getState(),this.$prevState)||!(Array.isArray(t)?rn(t,this.props.$memo):rn(this.props,r))}},{key:"_render",value:function e(){var r=this.$fieldutil=f(f(f({$name:this.props.name},this.$registered.$getState()),this.$registered),{},{$$formutil:this.$formContext.$formutil});return fn(r,this.props)}},{key:"render",value:function e(){var r=this;this.shouldRendered=true;return a["default"].createElement(J.Consumer,null,(function(e){var t=!r.$formContext;r.$formContext=e();if(!r.$fieldHandler){r.$fieldHandler=ln(r,r)}r.$registered=(r.$formContext.$$registers||{})[r.$fieldHandler.$name]||r.$fieldHandler;if(t){r.$fieldHandler.$$reset();r.$fieldHandler.$validate()}return r._render()}))}}]);return t}(r.Component);cn.displayName=un;var $n=["name","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$ref","$parser","$formatter","render","component","children"];function dn(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=function(r){I(i,r);var n=K(i);function i(){var r;j(this,i);for(var t=arguments.length,o=new Array(t),u=0;u<t;u++){o[u]=arguments[u]}r=n.call.apply(n,[this].concat(o));r.renderChildren=function(t){return a["default"].createElement(e,Object.assign({},r.othersProps,{$fieldutil:t,ref:r.props.__forwardRef__}))};return r}A(i,[{key:"render",value:function e(){var r=this.props,n=r.__forwardRef__,i=Dr(r,["__forwardRef__"]);var o=this.props,u=o.component,s=Dr(o,["component"]);$n.concat(Object.keys(f(f(f(f({},t.$validators),t.$asyncValidators),i.$validators),i.$asyncValidators))).forEach((function(e){if(e in i){if(e==="$validators"||e==="$asyncValidators"||e==="$defaultState"){s[e]=f(f({},t[e]),i[e])}delete i[e]}}));this.othersProps=i;return a["default"].createElement(cn,Object.assign({},t,s,{render:this.renderChildren}))}}]);return i}(r.Component);n.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous");var i=r.forwardRef((function(e,r){return a["default"].createElement(n,Object.assign({__forwardRef__:r},e))}));i.displayName="React.Formutil.withField.ForwardRef."+(e.displayName||e.name||"Anonymous");return qt(i,e)}var vn=vr(dn);var pn=function(e){I(t,e);var r=K(t);function t(){j(this,t);return r.apply(this,arguments)}A(t,[{key:"render",value:function e(){var r=this;var t=this.props,n=t.$fieldutil,i=t.value,o=t.onChange,u=t.onFocus,s=t.onBlur,f=t.checked,l=t.unchecked,c=Dr(t,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]);var $=this.props.type;var d={value:"compositionValue"in this?this.compositionValue:i,onCompositionEnd:function e(t){r.isComposing=false;delete r.compositionValue;d.onChange(t)},onCompositionStart:function e(){return r.isComposing=true},onChange:function e(t){var n=t.target.value;if(r.isComposing){r.compositionValue=n;r.forceUpdate()}else{o(n,t)}},onFocus:u,onBlur:function e(t){if(r.isComposing){r.isComposing=false;delete r.compositionValue;d.onChange(t)}return s(t)}};var v="input";switch($){case"select":v=$;d.onChange=function(e){var r=e.target;var t=r.multiple?[].slice.call(r.options).filter((function(e){return e.selected})).map((function(e){return e.value})):r.value;o(t,e)};delete c.type;break;case"textarea":v=$;delete c.type;break;case"checkbox":case"radio":d={checked:i===f,onChange:function e(r){o(r.target.checked?f:l,r)},onFocus:u,onBlur:s};break}return a["default"].createElement(v,Object.assign({},c,d))}}]);return t}(r.Component);pn.displayName="React.Formutil.EasyField.Native";pn.defaultProps={value:"",type:"text",checked:true,unchecked:false};var hn=r.createContext((function(){return{}})),mn=hn.Provider,yn=hn.Consumer;var gn=function(e){I(n,e);var t=K(n);function n(){var e;j(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++){a[i]=arguments[i]}e=t.call.apply(t,[this].concat(a));e.getGroupContext=function(){return e.props};return e}A(n,[{key:"_render",value:function e(){var t=this.props,n=t.className,i=t.groupNode,o=t.children;var u={GroupOption:bn,Field:wn};var s=or(o)?o(u):r.Children.map(o,(function(e){return r.cloneElement(e,u)}));if(i===null){return s}return a["default"].createElement(i,{className:n},s)}},{key:"render",value:function e(){return a["default"].createElement(mn,{value:this.getGroupContext},this._render())}}]);return n}(r.Component);gn.displayName="React.Formutil.EasyField.Group";gn.defaultProps={type:"checkbox",groupNode:"div"};var bn=function(e){I(t,e);var r=K(t);function t(){j(this,t);return r.apply(this,arguments)}A(t,[{key:"componentDidMount",value:function e(){W("$value"in this.props)}},{key:"render",value:function e(){var r=this.props,t=r.$value,n=r.onChange,i=r.onFocus,o=r.onBlur,u=Dr(r,["$value","onChange","onFocus","onBlur"]);return a["default"].createElement(yn,null,(function(e){var r=e();var s=r.type,f=r.name;var l=s==="radio"?{checked:r.value===t,onChange:function e(a){r.onChange(t,a);n&&n(a)}}:s==="checkbox"?{checked:r.value.indexOf(t)>-1,onChange:function e(a){r.onChange(a.target.checked?r.value.concat(t):r.value.filter((function(e){return e!==t})),a);n&&n(a)}}:{value:r.value,onChange:function e(t){r.onChange(t);n&&n(t)}};return a["default"].createElement("input",Object.assign({name:f},u,l,{type:s,onFocus:function e(t){r.onFocus(t);i&&i(t)},onBlur:function e(t){r.onBlur(t);o&&o(t)}}))}))}}]);return t}(r.Component);bn.displayName="React.Formutil.EasyField.Group.Option";var wn=function(e){I(t,e);var r=K(t);function t(){j(this,t);return r.apply(this,arguments)}A(t,[{key:"componentDidMount",value:function e(){}},{key:"render",value:function e(){return a["default"].createElement(bn,this.props)}}]);return t}(r.Component);wn.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var Sn=a["default"].Frament||"div";var Cn=function(e){I(t,e);var r=K(t);function t(e){var n;j(this,t);n=r.call(this,e);n.id=0;n.latestValue=n.props.value;n.$formutil=void 0;n.FieldValidators={required:function e(r){return r!==null}};n.$onFormChange=function(e){e.$onValidates((function(e){var r=e.$invalid,t=e.$params;if(r){if(n.props.value.length){n.props.onChange(n.latestValue=[])}}else if(!rn(n.props.value,t.list)){n.props.onChange(n.latestValue=t.list)}}))};n.swap=function(e,r,t){return n.$setState((function(t){var n=t.items;var a=[n[e],n[r]];n[r]=a[0];n[e]=a[1];return n}),t)};n.insert=function(){var e,r,t;for(var a=arguments.length,i=new Array(a),o=0;o<a;o++){i[o]=arguments[o]}i.forEach((function(n){if(or(n)){t=n}else if(typeof n==="number"){e=n}else if(typeof n==="object"){r=n}}));return n.$setState((function(t){var a=t.items;if(ir(e)){a.push(n.getId(r))}else{a.splice(e,0,n.getId(r))}return{items:a}}),t)};n.remove=function(){var e,r;for(var t=arguments.length,a=new Array(t),i=0;i<t;i++){a[i]=arguments[i]}a.forEach((function(t){if(or(t)){r=t}else if(typeof t==="number"){e=t}}));return n.$setState((function(r){var t=r.items;if(ir(e)){t.pop()}else{t.splice(e,1)}if(!t.length){t=[n.getId()]}return{items:t}}),r)};n.$setState=function(e,r){return new Promise((function(t){return n.setState(e,(function(){return n.$formutil.$onValidates((function(e){return t(dr(r,e))}))}))}))};n.state={items:e.value.length?e.value.map((function(){return n.getId()})):[n.getId()],formKey:0};return n}A(t,[{key:"componentDidUpdate",value:function e(r){var t=this;if(this.props.value!==this.latestValue){this.setState({items:this.props.value.length?this.props.value.map((function(){return t.getId()})):[this.getId()],formKey:this.state.formKey+1});this.latestValue=this.props.value}}},{key:"getId",value:function e(r){return{id:this.id++,values:r}}},{key:"render",value:function e(){var r=this;var t=this.props,n=t.children,i=t.onFocus,o=t.onBlur,u=t.value;var s=this;if(!or(n)){return null}var l={$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function e(t,n){return r.insert(t,n)},$pop:function e(t){return r.remove(t)},$shift:function e(t){return r.remove(0,t)},$unshift:function e(t,n){return r.insert(0,t,n)},onFocus:i,onBlur:o};return a["default"].createElement(jr,{key:this.state.formKey,$defaultValues:{list:u},$onFormChange:this.$onFormChange,children:function e(t){r.$formutil=t;return a["default"].createElement(Sn,null,r.state.items.map((function(e,i){var o=e.id,u=e.values;return a["default"].createElement(cn,{key:o,required:true,$defaultValue:u||null,$validators:r.FieldValidators,name:"list[".concat(i,"]"),children:function e(o){return a["default"].createElement(jr,{$defaultValues:o.$value||{},$onFormChange:function e(r){return r.$onValidates((function(e){var r=e.$invalid,t=e.$params;if(r){if(o.$viewValue!==null){o.$render(null)}}else if(!rn(o.$viewValue,t)){o.$render(t)}}))},children:function e(a){return n(f(f({get $length(){return s.state.items.length},$index:i,$isLast:function e(){return i===r.state.items.length-1},$isFirst:function e(){return i===0}},l),a),t)}})}})})))}})}}]);return t}(r.Component);Cn.displayName="React.Formutil.EasyField.List";var Pn="__TYPE__";var Fn=[["required",function(e,r,t){var n=t.__TYPE__,a=t.checked,i=a===void 0?true:a;return r===false||(n==="checked"?e===i:!ur(e))}],["maxLength",function(e,r){return ur(e)||e.length<=r*1}],["minLength",function(e,r){return ur(e)||e.length>=r*1}],["max",function(e,r){return ur(e)||e*1<=r*1}],["min",function(e,r){return ur(e)||e*1>=r*1}],["pattern",function(e,r){return ur(e)||r.test(e)}],["enum",function(e,r){return ur(e)||r.indexOf(e)>-1}],["checker",function(e,r,t){return r(e,t)}]].reduce((function(e,r){var t=E(r,2),n=t[0],a=t[1];e[n]=function e(r,t,i){var o=i.validMessage,u=o===void 0?{}:o;return a.apply(void 0,arguments)||u[n]||"Error input: ".concat(n)};return e}),{});var Vn="React.Formutil.EasyField";var On={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function e(r){return typeof r==="string"?r.trim():r}};function kn(e,r,t){var n;var a=r.valuePropName,i=r.changePropName,u=r.focusPropName,s=r.blurPropName,l=r.getValueFromEvent,c=r.passUtil;var $=function e(r){return r&&r.target?r.target[a]:r};var d=f(f({},t),{},(n={},o(n,a,e.$viewValue),o(n,i,(function(t){var n;for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++){o[u-1]=arguments[u]}if(((n=o[0])===null||n===void 0?void 0:n.nativeEvent)instanceof Event){o.push(t)}else{o.unshift(t)}var s=r[i];s&&s.apply(void 0,o);var f=l?l.apply(void 0,o):$(t);e.$render(f)})),o(n,u,(function(){var t=r[u];t&&t.apply(void 0,arguments);e.$setFocused(true)})),o(n,s,(function(){var t=r[s];t&&t.apply(void 0,arguments);if(e.$untouched){e.$setTouched(true)}e.$setFocused(false)})),n));if(c){d[c===true?"$fieldutil":String(c)]=e}return d}function En(e){var r=e.children,t=e.component,n=e.render,a=Dr(e,["children","component","render"]);var i=a.name,o=a.type,u=a.defaultValue,s=a.valuePropName,l=a.changePropName,c=a.focusPropName,$=a.blurPropName,d=a.getValueFromEvent,v=a.validMessage,p=a.checked,h=a.unchecked,m=a.__TYPE__,y=a.__DIFF__,g=a.passUtil,b=a.$defaultValue,w=a.$defaultState,S=a.$onFieldChange,C=a.$validators,P=a.$asyncValidators,F=a.$validateLazy,V=a.$memo,O=a.$reserveOnUnmount,k=a.$parser,_=a.$formatter,j=a.$ref,x=Dr(a,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","getValueFromEvent","validMessage","checked","unchecked","__TYPE__","__DIFF__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$parser","$formatter","$ref"]);var R={children:r,component:t,render:n};if(V===true&&ir(y)){a.__DIFF__=[r,t,n]}var A=!ir(o)||ir(r)&&ir(t)&&ir(n);Object.keys(f(f({},a.$validators=f(f({},Fn),a.$validators)),a.$asyncValidators)).forEach((function(e){if(e in x){if(!A||!hr(e)){delete x[e]}}}));if(A){var D=(o||"").split("."),N=E(D,2),U=N[0],M=U===void 0?"text":U,T=N[1];R.component=M==="group"?gn:M==="list"?Cn:pn;if(i){x.name=i}if(o){x.type=M}if(r){x.children=r}x.checked=p;x.unchecked=h;switch(M){case"select":case"textarea":if(e.multiple){a[Pn]="array"}break;case"group":if(T==="checkbox"){a[Pn]="array"}x.type=T;break;case"checkbox":case"radio":a[Pn]="checked";break;case"list":a[Pn]="array";break}}if(!("$defaultValue"in a)&&"defaultValue"in e){a.$defaultValue=u}if(!("$defaultValue"in a)&&Pn in a){var I;switch(a[Pn]){case"checked":var L=a.unchecked,H=L===void 0?false:L;I=H;break;case"array":I=[];break;case"object":I={};break;case"number":I=0;break}a.$defaultValue=I}return{fieldProps:a,childProps:x,renderProps:R}}function _n(e,t){var n=t.component,a=t.render,i=t.children;if(n){return r.createElement(n,e)}if(or(a)){return a(e)}if(or(i)){return i(e)}return r.Children.map(i,(function(t){return r.cloneElement(t,e)}))}var jn=function(e){I(t,e);var r=K(t);function t(){var e;j(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}e=r.call.apply(r,[this].concat(a));e.renderChildren=function(r){var t=e.parsedProps,n=t.fieldProps,a=t.childProps,i=t.renderProps;return _n(kn(r,n,a),i)};e.parsedProps={};return e}A(t,[{key:"render",value:function e(){var r=this.parsedProps=En(this.props),t=r.fieldProps;return a["default"].createElement(cn,Object.assign({},t,{children:this.renderChildren}))}}]);return t}(r.Component);jn.displayName=Vn;jn.defaultProps=On;function xn(e){var t=r.forwardRef((function(r,t){return a["default"].createElement(J.Consumer,null,(function(n){return a["default"].createElement(e,Object.assign({},r,{$formutil:n().$formutil,ref:t}))}))}));t.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous");return qt(t,e)}function Rn(){if(!a["default"].useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var e=a["default"].useContext;var r=e(J);return r()}function An(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!a["default"].useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var t=a["default"].useState,n=a["default"].useLayoutEffect,i=a["default"].useEffect,o=a["default"].useRef;var u=typeof window==="undefined"?i:n;var s;if(e){if(typeof e==="string"){s=e;r.name=s}else{r=e;s=r.name}}var l=Rn();var c=o({}).current;var $=o([]);var d;c.$formContext=l;c.props=r;c.$setState=m;c.shouldRendered=true;var v=t((function(){c.$$FIELD_UUID=sn();c.$fieldHandler=d=ln(c);c.$fieldHandler.$$reset();c.$fieldHandler.$validate()})),p=E(v,2),h=p[1];if(!d){d=(l.$$registers||{})[c.$fieldHandler.$name]||c.$fieldHandler}u((function(){var e=c.$state;if(c.isMounting){if(!(s in(l.$$registers||{}))){d.$$triggerChange({$newValue:e.$value,$prevValue:c.$prevState.$value})}}c.$prevState=e}),[c.$state.$value]);u((function(){c.isMounting=true;W(!s||l.$formutil);return function(){c.isMounting=false;br(r.$ref,null)}}),[]);u((function(){if(l.$$register){l.$$register(s,c.$fieldHandler)}return function(){if(l.$$unregister){l.$$unregister(s,c.$fieldHandler,!c.isMounting&&r.$reserveOnUnmount)}}}),[s]);u((function(){br(r.$ref,c.$fieldutil)}));u((function(){if($.current.length>0){var e=w($.current);$.current.length=0;while(e.length){e.pop()(c.$fieldutil)}}}));function m(e,r){return new Promise((function(t){var n=function e(){return t(dr(r,c.$fieldutil))};if(c.isMounting){if(s in(l.$$registers||{})){c.shouldRendered=false;l.$$onChange(s,e,n);if(!c.shouldRendered){h({})}}else{d.$$merge(e);d.$$detectChange(e);h({});$.current.push(n)}}else{d.$$merge(e);n()}}))}return c.$fieldutil=f(f(f({$name:s},d.$getState()),d),{},{$$formutil:l.$formutil})}function Dn(){var e=Rn(),r=e.$formutil;return r}function Nn(e){e=f(f(f({},On),e),{},{children:null});var r=En(e),t=r.fieldProps,n=r.childProps;var a=An(t);return kn(a,t,n)}e.EasyField=jn;e.Field=cn;e.Form=jr;e.connect=xn;e.formContext=J;e.useField=An;e.useForm=Dn;e.useHandler=Nn;e.withField=vn;e.withForm=Yt;Object.defineProperty(e,"__esModule",{value:true})}));
