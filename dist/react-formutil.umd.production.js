(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("react"),require("react-dom")):typeof define==="function"&&define.amd?define(["exports","react","react-dom"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.ReactFormutil={},e.React,e.ReactDOM))})(this,(function(e,t,r){"use strict";function n(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var a=n(t);function i(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var o=i;function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(t)n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}));r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};if(t%2){u(Object(r),true).forEach((function(t){o(e,t,r[t])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(r))}else{u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}}return e}var f=s;function l(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}var c=l;function $(e){if(Array.isArray(e))return c(e)}var d=$;function v(e){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}var p=v;function h(e,t){if(!e)return;if(typeof e==="string")return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}var m=h;function y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var g=y;function b(e){return d(e)||p(e)||m(e)||g()}var w=b;function S(e){if(Array.isArray(e))return e}var C=S;function P(e,t){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(e)))return;var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),u;!(n=(u=o.next()).done);n=true){r.push(u.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}var F=P;function V(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var O=V;function k(e,t){return C(e)||F(e,t)||m(e,t)||O()}var E=k;function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var j=_;function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function R(e,t,r){if(t)x(e.prototype,t);if(r)x(e,r);return e}var A=R;function D(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}var N=D;function U(e,t){return t={exports:{}},e(t,t.exports),t.exports}var M=U((function(e){function t(r,n){e.exports=t=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return t(r,n)}e.exports=t}));function T(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)M(e,t)}var I=T;var L=U((function(e){function t(r){e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return t(r)}e.exports=t}));function H(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}var z=H;var B=U((function(e){function t(r){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){e.exports=t=function e(t){return typeof t}}else{e.exports=t=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return t(r)}e.exports=t}));function Q(e,t){if(t&&(B(t)==="object"||typeof t==="function")){return t}return N(e)}var q=Q;function G(e){var t=z();return function r(){var n=L(e),a;if(t){var i=L(this).constructor;a=Reflect.construct(n,arguments,i)}else{a=n.apply(this,arguments)}return q(this,a)}}var K=G;var Y=function(){};var W=Y;var J=t.createContext((function(){return{}}));var X=60103,Z=60106,ee=60107,te=60108,re=60114,ne=60109,ae=60110,ie=60112,oe=60113,ue=60120,se=60115,fe=60116,le=60121,ce=60122,$e=60117,de=60129,ve=60131;if("function"===typeof Symbol&&Symbol.for){var pe=Symbol.for;X=pe("react.element");Z=pe("react.portal");ee=pe("react.fragment");te=pe("react.strict_mode");re=pe("react.profiler");ne=pe("react.provider");ae=pe("react.context");ie=pe("react.forward_ref");oe=pe("react.suspense");ue=pe("react.suspense_list");se=pe("react.memo");fe=pe("react.lazy");le=pe("react.block");ce=pe("react.server.block");$e=pe("react.fundamental");de=pe("react.debug_trace_mode");ve=pe("react.legacy_hidden")}function he(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case X:switch(e=e.type,e){case ee:case re:case te:case oe:case ue:return e;default:switch(e=e&&e.$$typeof,e){case ae:case ie:case fe:case se:case ne:return e;default:return t}}case Z:return t}}}var me=ne,ye=X,ge=ie,be=ee,we=fe,Se=se,Ce=Z,Pe=re,Fe=te,Ve=oe;var Oe=ae;var ke=me;var Ee=ye;var _e=ge;var je=be;var xe=we;var Re=Se;var Ae=Ce;var De=Pe;var Ne=Fe;var Ue=Ve;var Me=function(){return!1};var Te=function(){return!1};var Ie=function(e){return he(e)===ae};var Le=function(e){return he(e)===ne};var He=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===X};var ze=function(e){return he(e)===ie};var Be=function(e){return he(e)===ee};var Qe=function(e){return he(e)===fe};var qe=function(e){return he(e)===se};var Ge=function(e){return he(e)===Z};var Ke=function(e){return he(e)===re};var Ye=function(e){return he(e)===te};var We=function(e){return he(e)===oe};var Je=function(e){return"string"===typeof e||"function"===typeof e||e===ee||e===re||e===de||e===te||e===oe||e===ue||e===ve||"object"===typeof e&&null!==e&&(e.$$typeof===fe||e.$$typeof===se||e.$$typeof===ne||e.$$typeof===ae||e.$$typeof===ie||e.$$typeof===$e||e.$$typeof===le||e[0]===ce)?!0:!1};var Xe=he;var Ze={ContextConsumer:Oe,ContextProvider:ke,Element:Ee,ForwardRef:_e,Fragment:je,Lazy:xe,Memo:Re,Portal:Ae,Profiler:De,StrictMode:Ne,Suspense:Ue,isAsyncMode:Me,isConcurrentMode:Te,isContextConsumer:Ie,isContextProvider:Le,isElement:He,isForwardRef:ze,isFragment:Be,isLazy:Qe,isMemo:qe,isPortal:Ge,isProfiler:Ke,isStrictMode:Ye,isSuspense:We,isValidElementType:Je,typeOf:Xe};var et=U((function(e){{e.exports=Ze}}));var tt=et.isValidElementType;var rt=Object.getPrototypeOf({});var nt=/\s*(?:\]\s*\.|\]\s*\[|\.|\[|\])\s*/g;var at=typeof window==="undefined"?global:window;function it(e){return typeof e==="undefined"}function ot(e){return typeof e==="function"}function ut(e){return it(e)||e===null||e+""===""}function st(e){return!!e&&ot(e.then)}function ft(e){return Object.prototype.toString.call(e)==="[object Object]"}function lt(e){if(!ft(e))return false;if(null===Object.getPrototypeOf(e))return true;if(!ot(e.constructor))return false;return e.constructor.prototype===rt}function ct(e){return tt(e)&&typeof e!=="string"}function $t(e){if(Array.isArray(e)){var t=[];for(var r=0,n=e.length;r<n;r++){t[r]=$t(e[r])}return t}else if(lt(e)){var a={};for(var i in e){if(e.hasOwnProperty(i))a[i]=$t(e[i])}return a}return e}var dt=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++){n[a-1]=arguments[a]}if(ot(t)){t.apply(void 0,n)}return n[0]};function vt(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}if(ct(r[0])){return e.apply(void 0,r)}return function(t){return e(t,r[0])}}}var pt=["minlength","maxlength","max","min","required","pattern","step"];function ht(e){return pt.indexOf(e.toLowerCase())>-1}var mt=function e(t){try{var r=new Function("origin","global","return typeof ".concat(t," === 'number' || (typeof ").concat(t," !== 'undefined' && !(origin in global)) ? ").concat(t," : origin"));return r(t,at)}catch(e){return t}};function yt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}var n=t[0],a=t[1],i=t[2];W(typeof a==="string","The second parameter(".concat(JSON.stringify(a),") of parsePath() must be a string."));var o=(a.match(nt)||[]).map((function(e){return e.replace(/\s/g,"")}));var u=a.split(nt).map((function(e){return e.trim()})).filter((function(e){return e!==""}));var s=n;try{if(t.length<3){for(var l=0,c=u.length;l<c;l++){var $=mt(u[l]);if(l+1===c){return s[$]}if(it(s[$])){break}s=s[$]}}else{for(var d=0,v=u.length;d<v;d++){var p=mt(u[d]);var h=u[d+1];var m=o[d];if(it(h)){s[p]=i;break}switch(m){case"].":case".":s=s[p]=it(s[p])?{}:f({},s[p]);break;case"][":case"[":var y=mt(h);s=s[p]=it(s[p])?typeof y==="number"&&y>=0?[]:{}:Array.isArray(s[p])?w(s[p]):f({},s[p]);break;default:s[p]=i;break}}}}catch(e){}if(t.length>2){return n}}function gt(e,t){var r=t.split(nt).map((function(e){return e.trim()})).filter((function(e){return e!==""}));for(var n=0,a=r.length;n<a;n++){var i=mt(r[n]);if(!(i in e)){break}if(n+1===a){return{data:e[i]}}e=e[i]}}function bt(e,t){if(e){if(ot(e)){e(t)}else if("current"in e){e.current=t}}}var wt=function e(t,r){for(var n=0,a=t.length;n<a;n++){if(r(t[n])===true){return t[n]}}};var St=function e(t,r){return Object.keys(t).reduce((function(e,n){e[n]=r(t[n],n,t);return e}),{})};var Ct=function e(t,r){return Object.keys(t).forEach((function(e){return r(t[e],e,t)}))};var Pt=undefined;function Ft(e,t,r){Ct(e,(function(t,r){if(t===Pt){delete e[r]}else if(lt(t)||Array.isArray(t)){Ft(t,r,e)}}));if(r&&Object.keys(e).every((function(t){return e[t]===Pt}))){r[t]=Pt;Ft(r)}}var Vt=function e(t,r){if(!it(yt(t,r))){yt(t,r,Pt);Ft(t)}};function Ot(e,t){if(e===t){return true}var r=Object.keys(e);if(r.length!==Object.keys(t).length){return false}for(var n=0;n<r.length;n++){if(e[r[n]]!==t[r[n]]){return false}}return true}var kt="FORM_VALIDATE_RESULT";var Et,_t;if(typeof requestAnimationFrame==="function"){Et=requestAnimationFrame;_t=cancelAnimationFrame}else{Et=setTimeout;_t=clearTimeout}var jt=function(e){I(i,e);var n=K(i);function i(e){var t;j(this,i);t=n.call(this,e);t.$$formPending=void 0;t.$$formValidatePromise=void 0;t.$$registers={};t.$$deepRegisters={};t.getFormContext=function(){return{$$registers:t.$$registers,$$register:t.$$register,$$unregister:t.$$unregister,$$onChange:t.$$onChange,$$getDefault:t.$$getDefault,$formutil:t.$formutil}};t.$$regDuplications={};t.$$duplicateTimer=void 0;t.$$checkDuplication=function(){var e=N(t),r=e.$$regDuplications;var n;Ct(r,(function(e,t){var a=E(e,2),i=a[0],o=a[1];W(i.$$reserved);o.$$reset(i.$getState());n=delete r[t]}));if(n){t.$render()}};t.$$register=function(e,n,a){t.$$unregister(a,n);if(e){var i=t.$$getRegister(e);if(i){_t(t.$$duplicateTimer);t.$$regDuplications[e]=[i,n];t.$$duplicateTimer=Et((function(){return r.unstable_batchedUpdates(t.$$checkDuplication)}))}else{t.$$fieldChangedQueue.push({name:e,$newValue:n.$getState().$value});Vt(t.$$defaultValues,e)}t.$$registers[n.$name=e]=n;t.$$formShouldUpdateFields[e]=true;t.createDeepRegisters();t.$render()}};t.$$unregister=function(e,r,n){if(e){if(e in t.$$regDuplications){var a=E(t.$$regDuplications[e],2),i=a[0],o=a[1];t.$$fieldChangedQueue.push({name:e,$newValue:o.$getState().$value,$prevValue:i.$getState().$value});delete t.$$regDuplications[e]}else if(t.$$registers[e]===r){if(n){r.$$reserved=true}else{delete t.$$registers[e];t.$$fieldChangedQueue.push({name:e,$prevValue:r.$getState().$value});Vt(t.$$defaultValues,e)}}t.$$formShouldUpdateAll=true;t.createDeepRegisters();t.$render()}};t.$$defaultInitialize=function(){var e=t.props,r=e.$defaultValues,n=e.$defaultStates;t.$$defaultValues=t.$$deepParseObject($t(ot(r)?r(t.props)||{}:r));t.$$defaultStates=t.$$deepParseObject($t(ot(n)?n(t.props)||{}:n))};t.$$getDefault=function(){return{$$defaultStates:t.$$defaultStates,$$defaultValues:t.$$defaultValues}};t.$$formShouldUpdateFields={};t.$$formShouldUpdateAll=false;t.$$fieldChangedQueue=[];t.$$triggerFormChange=function(){if(t.$$fieldChangedQueue.length){var e=w(t.$$fieldChangedQueue);t.$$fieldChangedQueue.length=0;var r={};var n={};var a=t.$$registers;var i=false;e.forEach((function(e){if(!(e.name in a)){delete e.$newValue}if(e.$newValue!==e.$prevValue){if("$newValue"in e&&"$prevValue"in e){var o=t.$$getRegister(e.name);if(o){o.$$triggerChange(e)}}"$newValue"in e&&yt(r,e.name,e.$newValue);!e.$dirty&&"$prevValue"in e&&yt(n,e.name,e.$prevValue);i=true}}));if(i){if(ot(t.props.$validator)){t.$$formValidate()}if(ot(t.props.$onFormChange)){t.props.$onFormChange(t.$formutil,r,n)}}}};t.createDeepRegisters=function(){return t.$$deepRegisters=t.$$deepParseObject(t.$$registers)};t.$$getRegister=function(e){if(e){var r=t.$$registers[e]||yt(t.$$deepRegisters,e);if(r){return r}}};t.$$formValidate=function(){return t.$$formValidatePromise=new Promise((function(e){var r=t.props.$validator;var n;var a;var i;var o;var u=r(t.$formutil.$params,t.$formutil);var s=function t(r){return e(dt(i,r))};if(st(u)){if(!t.$$formPending){t.$$formPending=true;t.$render()}a=function e(t){return n=t(s)};o=u.then((function(){return void 0}),(function(e){return e})).then((function(e){if(n){return n}t.$shouldCancelPrevAsyncValidate=null;t.$$formPending=false;return t.$$setFormErrors(e,s)}))}else{if(t.$$formPending){t.$$formPending=false}o=t.$$setFormErrors(u,s)}if(t.$shouldCancelPrevAsyncValidate){t.$shouldCancelPrevAsyncValidate((function(e){i=e;return o}))}t.$shouldCancelPrevAsyncValidate=a}))};t.$$setFormErrors=function(e,r){if(e&&(e instanceof Error||typeof e!=="object")){return t.$render(r)}return t.$$setStates(e||{},(function(e,t){var r=t.$getState(),n=r.$error,a=n===void 0?{}:n;if(e){return{$error:f(f({},a),{},o({},kt,e))}}if(a[kt]){delete a[kt];return{$error:a}}}),r,true)};t.$getField=function(e){var r=t.$$getRegister(e);if(r){var n;return(n=r.$new)===null||n===void 0?void 0:n.call(r)}};t.$$onChange=function(e,r,n){return t.$setStates(o({},e,r),n)};t.$$setStates=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments.length>1?arguments[1]:undefined;var a=arguments.length>2?arguments[2]:undefined;var i=arguments.length>3?arguments[3]:undefined;var o=t.$$deepParseObject(e);var u=[];Ct(t.$$registers,(function(e,r){var a=gt(o,r);if(i||a){var s=e.$getState();var f=n(a&&a.data,e);if(f){var l=e.$$merge(f),c=l.$value;u.push([e,f]);if("$value"in f||"$viewValue"in f){var $=wt(t.$$fieldChangedQueue,(function(e){return e.name===r}));if($){if(!("$prevValue"in $)){$.$dirty=true;$.$prevValue=$.$newValue}$.$newValue=c}else{t.$$fieldChangedQueue.push({name:r,$newValue:c,$prevValue:s.$value})}}t.$$formShouldUpdateFields[r]=true}}}));return r.unstable_batchedUpdates((function(){u.forEach((function(e){var t=E(e,2),r=t[0],n=t[1];return r.$$detectChange(n)}));return t.$render(a)}))};t.$render=function(e){return new Promise((function(r){return t.forceUpdate((function(){return r(dt(e,t.$formutil))}))}))};t.$validates=function(){var e;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++){n[a]=arguments[a]}if(ot(n[n.length-1])){e=n.pop()}if(n.length){var i=function e(r){r.forEach((function(r){if(Array.isArray(r)){e(r)}else{var n=t.$getField(r);if(n){n.$validate()}}}))};i(n)}else{Ct(t.$$registers,(function(e){return e.$validate()}));if(ot(t.props.$validator)){t.$$formValidate()}}return t.$onValidates(e)};t.$onValidates=function(e){var r=Object.keys(t.$$registers).map((function(e){return t.$$registers[e].$onValidate()}));r.push(t.$$formValidatePromise);return Promise.all(r).then((function(){return dt(e,t.$formutil)}))};t.$validate=function(e,r){var n=t.$getField(e);if(n){return n.$validate(r)}return dt(r)};t.$reset=function(e,r){t.$$defaultInitialize();if(ot(e)){r=e;e={}}return t.$$setStates(e,(function(e,t){return t.$$reset(e)}),r,true)};t.$setStates=function(e,r){return t.$$setStates(e,(function(e){return e}),r)};t.$setValues=function(e,r){t.$$deepParseObject($t(e),t.$$defaultValues);Ft(t.$$defaultValues);return t.$$setStates(e,(function(e){return{$value:e}}),r)};t.$setFocuses=function(e,r){return t.$$setStates(e,(function(e){return{$focused:e}}),r)};t.$setDirts=function(e,r){return t.$$setStates(e,(function(e){return{$dirty:e}}),r)};t.$setTouches=function(e,r){return t.$$setStates(e,(function(e){return{$touched:e}}),r)};t.$setPendings=function(e,r){return t.$$setStates(e,(function(e){return{$pending:e}}),r)};t.$setErrors=function(e,r){return t.$$setStates(e,(function(e){return{$error:e}}),r)};t.$batchState=function(e,r){return t.$setStates(St(t.$$registers,(function(){return e})),r)};t.$batchDirty=function(e,r){return t.$batchState({$dirty:e},r)};t.$batchTouched=function(e,r){return t.$batchState({$touched:e},r)};t.$batchFocused=function(e,r){return t.$batchState({$focused:e},r)};t.$batchPending=function(e,r){return t.$batchState({$pending:e},r)};t.$batchError=function(e,r){return t.$batchState({$error:e},r)};t.$getFirstError=function(e){var r=t.$formutil;if(e){var n=r.$getField(e);return n&&n.$getFirstError()}for(var a in r.$weakErrors){if(r.$weakErrors.hasOwnProperty(a)){var i=r.$weakErrors[a];for(var o in i){if(i.hasOwnProperty(o)){return i[o]instanceof Error?i[o].message:i[o]}}}}};t.$new=function(){return t.$formutil};t.$$defaultInitialize();return t}A(i,[{key:"$$deepParseObject",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};Ct(t,(function(e,t){return yt(r,t,e)}));return r}},{key:"$$resetFormUpdateFields",value:function e(){this.$$formShouldUpdateFields={};this.$$formShouldUpdateAll=false}},{key:"componentDidMount",value:function e(){bt(this.props.$ref,this.$formutil)}},{key:"componentDidUpdate",value:function e(t){bt(this.props.$ref,this.$formutil);this.$$triggerFormChange()}},{key:"componentWillUnmount",value:function e(){bt(this.props.$ref,null)}},{key:"_render",value:function e(){var r=this.$formutil;var n=this.props,a=n.children,i=n.render,o=n.component;if(o){return t.createElement(o,{$formutil:r})}if(ot(i)){return i(r)}if(ot(a)){return a(r)}return t.Children.map(a,(function(e){return e&&ct(e.type)?t.cloneElement(e,{$formutil:r}):e}))}},{key:"render",value:function e(){var t=this;var r=this.props.$processer;var n=Object.keys(this.$$registers).map((function(e){return{path:e,$state:t.$$registers[e].$getState()}}));var i=this.$$formShouldUpdateAll;var o=this.$formutil||{};var u=n.some((function(e){var t=e.$state;return t.$invalid}));var s=n.some((function(e){var t=e.$state;return t.$dirty}));var l=n.some((function(e){var t=e.$state;return t.$touched}));var c=n.some((function(e){var t=e.$state;return t.$focused}));var $=this.$$formPending||n.some((function(e){var t=e.$state;return t.$pending}));var d=i?{}:f({},o.$pureParams);var v=i?{}:f({},o.$states);var p=i?{}:f({},o.$errors);var h=i?{}:f({},o.$dirts);var m=i?{}:f({},o.$touches);var y=i?{}:f({},o.$focuses);var g=i?{}:f({},o.$pendings);var b=i?{}:f({},o.$weakStates);var w=i?{}:f({},o.$weakParams);var S=i?{}:f({},o.$weakErrors);var C=i?{}:f({},o.$weakDirts);var P=i?{}:f({},o.$weakFocuses);var F=i?{}:f({},o.$weakTouches);var V=i?{}:f({},o.$weakPendings);for(var O=0,k=n.length;O<k;O++){var E=n[O],_=E.$state,j=E.path;if(!i){if(!this.$$formShouldUpdateFields[j]){continue}}if(r){r(_,j)}if(j in w&&_.$pristine&&it(_.$value)){delete w[j];Vt(d,j)}else if(w[j]!==_.$value){w[j]=_.$value;yt(d,j,_.$value)}yt(v,j,_);b[j]=_;if(S[j]!==_.$error){if(_.$invalid){yt(p,j,_.$error);S[j]=_.$error}else if(j in S){Vt(p,j);delete S[j]}}if(C[j]!==_.$dirty){yt(h,j,_.$dirty);C[j]=_.$dirty}if(F[j]!==_.$touched){yt(m,j,_.$touched);F[j]=_.$touched}if(P[j]!==_.$focused){yt(y,j,_.$focused);P[j]=_.$focused}if(V[j]!==_.$pending){yt(g,j,_.$pending);V[j]=_.$pending}}this.$formutil={$$registers:f({},this.$$registers),$$deepRegisters:this.$$deepRegisters,$states:v,$pureParams:d,$params:f(f({},this.$$defaultValues),d),$errors:p,$dirts:h,$touches:m,$focuses:y,$pendings:g,$weakStates:b,$weakParams:w,$weakErrors:S,$weakDirts:C,$weakTouches:F,$weakFocuses:P,$weakPendings:V,$getFirstError:this.$getFirstError,$render:this.$render,$getField:this.$getField,$onValidates:this.$onValidates,$new:this.$new,$setStates:this.$setStates,$setValues:this.$setValues,$setErrors:this.$setErrors,$setTouches:this.$setTouches,$setDirts:this.$setDirts,$setFocuses:this.$setFocuses,$setPendings:this.$setPendings,$batchState:this.$batchState,$batchTouched:this.$batchTouched,$batchDirty:this.$batchDirty,$batchFocused:this.$batchFocused,$batchPending:this.$batchPending,$reset:this.$reset,$validates:this.$validates,$validate:this.$validate,$valid:!u,$invalid:u,$dirty:s,$pristine:!s,$touched:l,$untouched:!l,$focused:c,$pending:$};this.$$resetFormUpdateFields();return a["default"].createElement(J.Provider,{value:this.getFormContext},this._render())}}]);return i}(t.Component);jt.displayName="React.Formutil.Form";jt.defaultProps={$defaultValues:{},$defaultStates:{}};function xt(e,t){if(e==null)return{};var r={};var n=Object.keys(e);var a,i;for(i=0;i<n.length;i++){a=n[i];if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}var Rt=xt;function At(e,t){if(e==null)return{};var r=Rt(e,t);var n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++){n=i[a];if(t.indexOf(n)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(e,n))continue;r[n]=e[n]}}return r}var Dt=At;var Nt="function"===typeof Symbol&&Symbol.for,Ut=Nt?Symbol.for("react.element"):60103,Mt=Nt?Symbol.for("react.portal"):60106,Tt=Nt?Symbol.for("react.fragment"):60107,It=Nt?Symbol.for("react.strict_mode"):60108,Lt=Nt?Symbol.for("react.profiler"):60114,Ht=Nt?Symbol.for("react.provider"):60109,zt=Nt?Symbol.for("react.context"):60110,Bt=Nt?Symbol.for("react.async_mode"):60111,Qt=Nt?Symbol.for("react.concurrent_mode"):60111,qt=Nt?Symbol.for("react.forward_ref"):60112,Gt=Nt?Symbol.for("react.suspense"):60113,Kt=Nt?Symbol.for("react.suspense_list"):60120,Yt=Nt?Symbol.for("react.memo"):60115,Wt=Nt?Symbol.for("react.lazy"):60116,Jt=Nt?Symbol.for("react.block"):60121,Xt=Nt?Symbol.for("react.fundamental"):60117,Zt=Nt?Symbol.for("react.responder"):60118,er=Nt?Symbol.for("react.scope"):60119;function tr(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case Ut:switch(e=e.type,e){case Bt:case Qt:case Tt:case Lt:case It:case Gt:return e;default:switch(e=e&&e.$$typeof,e){case zt:case qt:case Wt:case Yt:case Ht:return e;default:return t}}case Mt:return t}}}function rr(e){return tr(e)===Qt}var nr=Bt;var ar=Qt;var ir=zt;var or=Ht;var ur=Ut;var sr=qt;var fr=Tt;var lr=Wt;var cr=Yt;var $r=Mt;var dr=Lt;var vr=It;var pr=Gt;var hr=function(e){return rr(e)||tr(e)===Bt};var mr=rr;var yr=function(e){return tr(e)===zt};var gr=function(e){return tr(e)===Ht};var br=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===Ut};var wr=function(e){return tr(e)===qt};var Sr=function(e){return tr(e)===Tt};var Cr=function(e){return tr(e)===Wt};var Pr=function(e){return tr(e)===Yt};var Fr=function(e){return tr(e)===Mt};var Vr=function(e){return tr(e)===Lt};var Or=function(e){return tr(e)===It};var kr=function(e){return tr(e)===Gt};var Er=function(e){return"string"===typeof e||"function"===typeof e||e===Tt||e===Qt||e===Lt||e===It||e===Gt||e===Kt||"object"===typeof e&&null!==e&&(e.$$typeof===Wt||e.$$typeof===Yt||e.$$typeof===Ht||e.$$typeof===zt||e.$$typeof===qt||e.$$typeof===Xt||e.$$typeof===Zt||e.$$typeof===er||e.$$typeof===Jt)};var _r=tr;var jr={AsyncMode:nr,ConcurrentMode:ar,ContextConsumer:ir,ContextProvider:or,Element:ur,ForwardRef:sr,Fragment:fr,Lazy:lr,Memo:cr,Portal:$r,Profiler:dr,StrictMode:vr,Suspense:pr,isAsyncMode:hr,isConcurrentMode:mr,isContextConsumer:yr,isContextProvider:gr,isElement:br,isForwardRef:wr,isFragment:Sr,isLazy:Cr,isMemo:Pr,isPortal:Fr,isProfiler:Vr,isStrictMode:Or,isSuspense:kr,isValidElementType:Er,typeOf:_r};var xr=U((function(e){{e.exports=jr}}));var Rr={childContextTypes:true,contextType:true,contextTypes:true,defaultProps:true,displayName:true,getDefaultProps:true,getDerivedStateFromError:true,getDerivedStateFromProps:true,mixins:true,propTypes:true,type:true};var Ar={name:true,length:true,prototype:true,caller:true,callee:true,arguments:true,arity:true};var Dr={$$typeof:true,render:true,defaultProps:true,displayName:true,propTypes:true};var Nr={$$typeof:true,compare:true,defaultProps:true,displayName:true,propTypes:true,type:true};var Ur={};Ur[xr.ForwardRef]=Dr;Ur[xr.Memo]=Nr;function Mr(e){if(xr.isMemo(e)){return Nr}return Ur[e["$$typeof"]]||Rr}var Tr=Object.defineProperty;var Ir=Object.getOwnPropertyNames;var Lr=Object.getOwnPropertySymbols;var Hr=Object.getOwnPropertyDescriptor;var zr=Object.getPrototypeOf;var Br=Object.prototype;function Qr(e,t,r){if(typeof t!=="string"){if(Br){var n=zr(t);if(n&&n!==Br){Qr(e,n,r)}}var a=Ir(t);if(Lr){a=a.concat(Lr(t))}var i=Mr(e);var o=Mr(t);for(var u=0;u<a.length;++u){var s=a[u];if(!Ar[s]&&!(r&&r[s])&&!(o&&o[s])&&!(i&&i[s])){var f=Hr(t,s);try{Tr(e,s,f)}catch(e){}}}}return e}var qr=Qr;var Gr=["render","component","children","$defaultValues","$defaultStates","$onFormChange","$validator","$processer","$ref"];function Kr(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=function(t){I(i,t);var n=K(i);function i(){var t;j(this,i);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++){o[u]=arguments[u]}t=n.call.apply(n,[this].concat(o));t.renderChildren=function(r){return a["default"].createElement(e,Object.assign({},t.othersProps,{$formutil:r,ref:t.props.__forwardRef__}))};return t}A(i,[{key:"render",value:function e(){var t=this.props,n=t.__forwardRef__,i=Dt(t,["__forwardRef__"]);var o=this.props,u=o.component,s=Dt(o,["component"]);Gr.forEach((function(e){if(e in i){if(e==="$defaultStates"||e==="$defaultValues"){s[e]=f(f({},r[e]),i[e])}delete i[e]}}));this.othersProps=i;return a["default"].createElement(jt,Object.assign({},r,s,{render:this.renderChildren}))}}]);return i}(t.Component);n.displayName="React.Formutil.withForm."+(e.displayName||e.name||"Anonymous");var i=t.forwardRef((function(e,t){return a["default"].createElement(n,Object.assign({__forwardRef__:t},e))}));i.displayName="React.Formutil.withForm.ForwardRef."+(e.displayName||e.name||"Anonymous");return qr(i,e)}var Yr=vt(Kr);var Wr=typeof Element!=="undefined";var Jr=typeof Map==="function";var Xr=typeof Set==="function";var Zr=typeof ArrayBuffer==="function"&&!!ArrayBuffer.isView;function en(e,t){if(e===t)return true;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return false;var r,n,a;if(Array.isArray(e)){r=e.length;if(r!=t.length)return false;for(n=r;n--!==0;)if(!en(e[n],t[n]))return false;return true}var i;if(Jr&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return false;i=e.entries();while(!(n=i.next()).done)if(!t.has(n.value[0]))return false;i=e.entries();while(!(n=i.next()).done)if(!en(n.value[1],t.get(n.value[0])))return false;return true}if(Xr&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return false;i=e.entries();while(!(n=i.next()).done)if(!t.has(n.value[0]))return false;return true}if(Zr&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){r=e.length;if(r!=t.length)return false;for(n=r;n--!==0;)if(e[n]!==t[n])return false;return true}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();a=Object.keys(e);r=a.length;if(r!==Object.keys(t).length)return false;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[n]))return false;if(Wr&&e instanceof Element)return false;for(n=r;n--!==0;){if((a[n]==="_owner"||a[n]==="__v"||a[n]==="__o")&&e.$$typeof){continue}if(!en(e[a[n]],t[a[n]]))return false}return true}return e!==e&&t!==t}var tn=function e(t,r){try{return en(t,r)}catch(e){if((e.message||"").match(/stack|recursion/i)){console.warn("react-fast-compare cannot handle circular refs");return false}throw e}};var rn=0;var nn={$valid:true,$invalid:false,$dirty:false,$pristine:true,$touched:false,$untouched:true,$focused:false,$pending:false,$error:{}};function an(e){return e!==true}function on(e,t,r){}var un="React.Formutil.Field";function sn(){return rn++}function fn(e,r){var n=r.children,a=r.render,i=r.component;if(i){return t.createElement(i,{$fieldutil:e})}if(ot(a)){return a(e)}if(ot(n)){return n(e)}return t.Children.map(n,(function(r){return r&&ct(r.type)?t.cloneElement(r,{$fieldutil:e}):r}))}function ln(e,t){var r={$$FIELD_UUID:e.$$FIELD_UUID,$$reset:u,$$merge:b,$$detectChange:a,$$triggerChange:i,$onValidate:o,$new:function t(){return e.$fieldutil},$picker:s,$getState:s,$getComponent:function e(){return t},$reset:function t(r,n){return e.$setState(u(r),n)},$getFirstError:g,$validate:l,$setState:e.$setState,$render:c,$setValue:$,$setTouched:d,$setDirty:v,$setFocused:p,$setValidity:m,$setError:h,$setPending:y};var n;function a(e){if("$value"in e||"$viewValue"in e){l()}}function i(t){var r=t.$newValue,n=t.$prevValue;var a=e.props.$onFieldChange;if(ot(a)){a(r,n,e.$formContext.$formutil)}}function o(e){n.then(e);return n}function u(t){var r;var n=e.props,a=e.$formContext;if(a.$$getDefault){var i=n.name;var o=a.$$getDefault(),u=o.$$defaultStates,s=o.$$defaultValues;if(i&&s){var l=yt(s,i);r=yt(u,i)||{};if(!it(l)){r.$value=l}}}var c=n.$defaultValue,$=n.$defaultState;return b(f(f(f(f({},nn),ot($)?$(n):$),{},{$value:ot(c)?c(n):"$defaultValue"in n?c:""},r),t))}function s(){return f({},e.$state)}function l(t){return n=new Promise((function(r){var n=e.props,a=e.$formContext;var i=f(f({},n.$validators),n.$asyncValidators);var o=e.$state,u=o.$value,s=o.$pending,l=Object.assign({},o.$error);var c=a.$formutil;var $={};var d=false;var v;var p;var g;var b;delete l[kt];var w=Object.keys(i).reduce((function(t,r){delete l[r];if(!d&&n[r]!=null){var a=i[r](u,n[r],f(f({},n),{},{$formutil:c,$fieldutil:e.$fieldutil,$validError:$}));if(st(a)){t.push(a.catch((function(e){if(!v){m(r,e||r)}})))}else if(an(a)){$[r]=a||r;on(a,r,n.name);if(n.$validateLazy){d=true}}}return t}),[]);var S=function e(n){return r(dt(t,dt(g,n)))};if(w.length){if(!s){y(true)}p=function e(t){return v=t(S)};w.push(h(f(f({},l),$)));b=Promise.all(w).then((function(){if(v){return v}e.$shouldCancelPrevAsyncValidate=null;return y(false,S)}))}else{if(s){y(false)}b=h(f(f({},l),$),S)}if(e.$shouldCancelPrevAsyncValidate){e.$shouldCancelPrevAsyncValidate((function(e){g=e;return b}))}e.$shouldCancelPrevAsyncValidate=p}))}function c(t,r){return e.$setState({$viewValue:t,$dirty:true},r)}function $(t,r){return e.$setState({$value:t},r)}function d(t,r){return e.$setState({$touched:t},r)}function v(t,r){return e.$setState({$dirty:t},r)}function p(t,r){return e.$setState({$focused:t},r)}function h(t,r){return e.$setState({$error:t},r)}function m(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var n=arguments.length>2?arguments[2]:undefined;var a=Object.assign({},e.$state.$error);if(an(r)){a[t]=r||t;on(r,t,e.props.name)}else{delete a[t]}return h(a,n)}function y(t,r){return e.$setState({$pending:t},r)}function g(){var t=e.$state.$error,r=t===void 0?{}:t;for(var n in r){if(r.hasOwnProperty(n)){return r[n]instanceof Error?r[n].message:r[n]}}}function b(t){var r=Object.assign({},t);if("$error"in r){if(!r.$error){r.$error={}}r.$valid=Object.keys(r.$error).length===0}var n=e.props,a=n.$parser,i=n.$formatter;if("$viewValue"in r&&!("$value"in r)){var o=function e(t){return r.$viewValue=t};r.$value=a?a(r.$viewValue,o):r.$viewValue}else if("$value"in r&&!("$viewValue"in r)){var u=function e(t){return r.$value=t};r.$viewValue=i?i(r.$value,u):r.$value}if("$valid"in r){r.$invalid=!r.$valid}else if("$invalid"in r){r.$valid=!r.$invalid}if("$dirty"in r){r.$pristine=!r.$dirty}else if("$pristine"in r){r.$dirty=!r.$pristine}if("$touched"in r){r.$untouched=!r.$touched}else if("$untouched"in r){r.$touched=!r.$untouched}e.$state=f(f({},e.$state),r);return s()}return r}var cn=function(e){I(r,e);var t=K(r);function r(){var e;j(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}e=t.call.apply(t,[this].concat(a));e.$$FIELD_UUID=sn();e.$formContext=void 0;e.$state=void 0;e.shouldRendered=false;e.$setState=function(t,r){return new Promise((function(n){var a=function t(){return n(dt(r,e.$fieldutil))};if(e.isMounting){var i=e.props.name;if(i in(e.$formContext.$$registers||{})){e.shouldRendered=false;e.$formContext.$$onChange(i,t,a);if(!e.shouldRendered){e.forceUpdate()}}else{e.$registered.$$merge(t);e.$registered.$$detectChange(t);e.forceUpdate(a)}}else{e.$registered.$$merge(t);a()}}))};return e}A(r,[{key:"componentDidMount",value:function e(){this.isMounting=true;var t=this.props.name,r=this.$formContext;W(!t||r.$formutil);if(r.$$register){r.$$register(t,this.$fieldHandler)}this.$prevState=this.$state;bt(this.props.$ref,this.$fieldutil)}},{key:"componentWillUnmount",value:function e(){if(this.$formContext.$$unregister){this.$formContext.$$unregister(this.props.name,this.$fieldHandler,this.props.$reserveOnUnmount)}this.isMounting=false;bt(this.props.$ref,null)}},{key:"componentDidUpdate",value:function e(t){var r=this.props.name;if(r!==t.name){if(this.$formContext.$$register){this.$formContext.$$register(r,this.$fieldHandler,t.name)}}bt(this.props.$ref,this.$fieldutil);if(this.$state.$value!==this.$prevState.$value){if(!(r in(this.$formContext.$$registers||{}))){this.$registered.$$triggerChange({$newValue:this.$state.$value,$prevValue:this.$prevState.$value})}}this.$prevState=this.$state}},{key:"shouldComponentUpdate",value:function e(t){var r=t.$memo;return!r||!Ot(this.$registered.$getState(),this.$prevState)||!(Array.isArray(r)?tn(r,this.props.$memo):tn(this.props,t))}},{key:"_render",value:function e(){var t=this.$fieldutil=f(f(f({$name:this.props.name},this.$registered.$getState()),this.$registered),{},{$$formutil:this.$formContext.$formutil});return fn(t,this.props)}},{key:"render",value:function e(){var t=this;this.shouldRendered=true;return a["default"].createElement(J.Consumer,null,(function(e){var r=!t.$formContext;t.$formContext=e();if(!t.$fieldHandler){t.$fieldHandler=ln(t,t)}t.$registered=(t.$formContext.$$registers||{})[t.$fieldHandler.$name]||t.$fieldHandler;if(r){t.$fieldHandler.$$reset();t.$fieldHandler.$validate()}return t._render()}))}}]);return r}(t.Component);cn.displayName=un;var $n=["name","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$ref","$parser","$formatter","render","component","children"];function dn(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=function(t){I(i,t);var n=K(i);function i(){var t;j(this,i);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++){o[u]=arguments[u]}t=n.call.apply(n,[this].concat(o));t.renderChildren=function(r){return a["default"].createElement(e,Object.assign({},t.othersProps,{$fieldutil:r,ref:t.props.__forwardRef__}))};return t}A(i,[{key:"render",value:function e(){var t=this.props,n=t.__forwardRef__,i=Dt(t,["__forwardRef__"]);var o=this.props,u=o.component,s=Dt(o,["component"]);$n.concat(Object.keys(f(f(f(f({},r.$validators),r.$asyncValidators),i.$validators),i.$asyncValidators))).forEach((function(e){if(e in i){if(e==="$validators"||e==="$asyncValidators"||e==="$defaultState"){s[e]=f(f({},r[e]),i[e])}delete i[e]}}));this.othersProps=i;return a["default"].createElement(cn,Object.assign({},r,s,{render:this.renderChildren}))}}]);return i}(t.Component);n.displayName="React.Formutil.withField."+(e.displayName||e.name||"Anonymous");var i=t.forwardRef((function(e,t){return a["default"].createElement(n,Object.assign({__forwardRef__:t},e))}));i.displayName="React.Formutil.withField.ForwardRef."+(e.displayName||e.name||"Anonymous");return qr(i,e)}var vn=vt(dn);var pn=function(e){I(r,e);var t=K(r);function r(){j(this,r);return t.apply(this,arguments)}A(r,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.$fieldutil,i=r.value,o=r.onChange,u=r.onFocus,s=r.onBlur,f=r.checked,l=r.unchecked,c=Dt(r,["$fieldutil","value","onChange","onFocus","onBlur","checked","unchecked"]);var $=this.props.type;var d={value:"compositionValue"in this?this.compositionValue:i,onCompositionEnd:function e(r){t.isComposing=false;delete t.compositionValue;d.onChange(r)},onCompositionStart:function e(){return t.isComposing=true},onChange:function e(r){var n=r.target.value;if(t.isComposing){t.compositionValue=n;t.forceUpdate()}else{o(n,r)}},onFocus:u,onBlur:function e(r){if(t.isComposing){t.isComposing=false;delete t.compositionValue;d.onChange(r)}return s(r)}};var v="input";switch($){case"select":v=$;d.onChange=function(e){var t=e.target;var r=t.multiple?[].slice.call(t.options).filter((function(e){return e.selected})).map((function(e){return e.value})):t.value;o(r,e)};delete c.type;break;case"textarea":v=$;delete c.type;break;case"checkbox":case"radio":d={checked:i===f,onChange:function e(t){o(t.target.checked?f:l,t)},onFocus:u,onBlur:s};break}return a["default"].createElement(v,Object.assign({},c,d))}}]);return r}(t.Component);pn.displayName="React.Formutil.EasyField.Native";pn.defaultProps={value:"",type:"text",checked:true,unchecked:false};var hn=t.createContext((function(){return{}})),mn=hn.Provider,yn=hn.Consumer;var gn=function(e){I(n,e);var r=K(n);function n(){var e;j(this,n);for(var t=arguments.length,a=new Array(t),i=0;i<t;i++){a[i]=arguments[i]}e=r.call.apply(r,[this].concat(a));e.getGroupContext=function(){return e.props};return e}A(n,[{key:"_render",value:function e(){var r=this.props,n=r.className,i=r.groupNode,o=r.children;var u={GroupOption:bn,Field:wn};var s=ot(o)?o(u):t.Children.map(o,(function(e){return t.cloneElement(e,u)}));if(i===null){return s}return a["default"].createElement(i,{className:n},s)}},{key:"render",value:function e(){return a["default"].createElement(mn,{value:this.getGroupContext},this._render())}}]);return n}(t.Component);gn.displayName="React.Formutil.EasyField.Group";gn.defaultProps={type:"checkbox",groupNode:"div"};var bn=function(e){I(r,e);var t=K(r);function r(){j(this,r);return t.apply(this,arguments)}A(r,[{key:"componentDidMount",value:function e(){W("$value"in this.props)}},{key:"render",value:function e(){var t=this.props,r=t.$value,n=t.onChange,i=t.onFocus,o=t.onBlur,u=Dt(t,["$value","onChange","onFocus","onBlur"]);return a["default"].createElement(yn,null,(function(e){var t=e();var s=t.type,f=t.name;var l=s==="radio"?{checked:t.value===r,onChange:function e(a){t.onChange(r,a);n&&n(a)}}:s==="checkbox"?{checked:t.value.indexOf(r)>-1,onChange:function e(a){t.onChange(a.target.checked?t.value.concat(r):t.value.filter((function(e){return e!==r})),a);n&&n(a)}}:{value:t.value,onChange:function e(r){t.onChange(r);n&&n(r)}};return a["default"].createElement("input",Object.assign({name:f},u,l,{type:s,onFocus:function e(r){t.onFocus(r);i&&i(r)},onBlur:function e(r){t.onBlur(r);o&&o(r)}}))}))}}]);return r}(t.Component);bn.displayName="React.Formutil.EasyField.Group.Option";var wn=function(e){I(r,e);var t=K(r);function r(){j(this,r);return t.apply(this,arguments)}A(r,[{key:"componentDidMount",value:function e(){}},{key:"render",value:function e(){return a["default"].createElement(bn,this.props)}}]);return r}(t.Component);wn.displayName="React.Formutil.EasyField.Group.Option.Deprecated";var Sn=a["default"].Frament||"div";var Cn=function(e){I(r,e);var t=K(r);function r(e){var n;j(this,r);n=t.call(this,e);n.id=0;n.latestValue=n.props.value;n.$formutil=void 0;n.FieldValidators={required:function e(t){return t!==null}};n.$onFormChange=function(e){e.$onValidates((function(e){var t=e.$invalid,r=e.$params;if(t){if(n.props.value.length){n.props.onChange(n.latestValue=[])}}else if(!tn(n.props.value,r.list)){n.props.onChange(n.latestValue=r.list)}}))};n.swap=function(e,t,r){return n.$setState((function(r){var n=r.items;var a=[n[e],n[t]];n[t]=a[0];n[e]=a[1];return n}),r)};n.insert=function(){var e,t,r;for(var a=arguments.length,i=new Array(a),o=0;o<a;o++){i[o]=arguments[o]}i.forEach((function(n){if(ot(n)){r=n}else if(typeof n==="number"){e=n}else if(typeof n==="object"){t=n}}));return n.$setState((function(r){var a=r.items;if(it(e)){a.push(n.getId(t))}else{a.splice(e,0,n.getId(t))}return{items:a}}),r)};n.remove=function(){var e,t;for(var r=arguments.length,a=new Array(r),i=0;i<r;i++){a[i]=arguments[i]}a.forEach((function(r){if(ot(r)){t=r}else if(typeof r==="number"){e=r}}));return n.$setState((function(t){var r=t.items;if(it(e)){r.pop()}else{r.splice(e,1)}if(!r.length){r=[n.getId()]}return{items:r}}),t)};n.$setState=function(e,t){return new Promise((function(r){return n.setState(e,(function(){return n.$formutil.$onValidates((function(e){return r(dt(t,e))}))}))}))};n.state={items:e.value.length?e.value.map((function(){return n.getId()})):[n.getId()],formKey:0};return n}A(r,[{key:"componentDidUpdate",value:function e(t){var r=this;if(this.props.value!==this.latestValue){this.setState({items:this.props.value.length?this.props.value.map((function(){return r.getId()})):[this.getId()],formKey:this.state.formKey+1});this.latestValue=this.props.value}}},{key:"getId",value:function e(t){return{id:this.id++,values:t}}},{key:"render",value:function e(){var t=this;var r=this.props,n=r.children,i=r.onFocus,o=r.onBlur,u=r.value;var s=this;if(!ot(n)){return null}var l={$insert:this.insert,$remove:this.remove,$swap:this.swap,$push:function e(r,n){return t.insert(r,n)},$pop:function e(r){return t.remove(r)},$shift:function e(r){return t.remove(0,r)},$unshift:function e(r,n){return t.insert(0,r,n)},onFocus:i,onBlur:o};return a["default"].createElement(jt,{key:this.state.formKey,$defaultValues:{list:u},$onFormChange:this.$onFormChange,children:function e(r){t.$formutil=r;return a["default"].createElement(Sn,null,t.state.items.map((function(e,i){var o=e.id,u=e.values;return a["default"].createElement(cn,{key:o,required:true,$defaultValue:u||null,$validators:t.FieldValidators,name:"list[".concat(i,"]"),children:function e(o){return a["default"].createElement(jt,{$defaultValues:o.$value||{},$onFormChange:function e(t){return t.$onValidates((function(e){var t=e.$invalid,r=e.$params;if(!tn(o.$viewValue,r)){o.$setState({$viewValue:r,$value:t?null:r})}}))},children:function e(a){return n(f(f({get $length(){return s.state.items.length},$index:i,$isLast:function e(){return i===t.state.items.length-1},$isFirst:function e(){return i===0}},l),a),r)}})}})})))}})}}]);return r}(t.Component);Cn.displayName="React.Formutil.EasyField.List";var Pn="__TYPE__";var Fn=[["required",function(e,t,r){var n=r.__TYPE__,a=r.checked,i=a===void 0?true:a;return t===false||(n==="checked"?e===i:!ut(e))}],["maxLength",function(e,t){return ut(e)||e.length<=t*1}],["minLength",function(e,t){return ut(e)||e.length>=t*1}],["max",function(e,t){return ut(e)||e*1<=t*1}],["min",function(e,t){return ut(e)||e*1>=t*1}],["pattern",function(e,t){return ut(e)||t.test(e)}],["enum",function(e,t){return ut(e)||t.indexOf(e)>-1}],["checker",function(e,t,r){return t(e,r)}]].reduce((function(e,t){var r=E(t,2),n=r[0],a=r[1];e[n]=function e(t,r,i){var o=i.validMessage,u=o===void 0?{}:o;return a.apply(void 0,arguments)||u[n]||"Error input: ".concat(n)};return e}),{});var Vn="React.Formutil.EasyField";var On={validMessage:{},valuePropName:"value",changePropName:"onChange",focusPropName:"onFocus",blurPropName:"onBlur",$parser:function e(t){return typeof t==="string"?t.trim():t}};function kn(e,t,r){var n;var a=t.valuePropName,i=t.changePropName,u=t.focusPropName,s=t.blurPropName,l=t.getValueFromEvent,c=t.passUtil;var $=function e(t){return t&&t.target?t.target[a]:t};var d=f(f({},r),{},(n={},o(n,a,e.$viewValue),o(n,i,(function(r){var n;for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++){o[u-1]=arguments[u]}if(((n=o[0])===null||n===void 0?void 0:n.nativeEvent)instanceof Event){o.push(r)}else{o.unshift(r)}var s=t[i];s&&s.apply(void 0,o);var f=l?l.apply(void 0,o):$(r);e.$render(f)})),o(n,u,(function(){var r=t[u];r&&r.apply(void 0,arguments);e.$setFocused(true)})),o(n,s,(function(){var r=t[s];r&&r.apply(void 0,arguments);if(e.$untouched){e.$setTouched(true)}e.$setFocused(false)})),n));if(c){d[c===true?"$fieldutil":String(c)]=e}return d}function En(e){var t=e.children,r=e.component,n=e.render,a=Dt(e,["children","component","render"]);var i=a.name,o=a.type,u=a.defaultValue,s=a.valuePropName,l=a.changePropName,c=a.focusPropName,$=a.blurPropName,d=a.getValueFromEvent,v=a.validMessage,p=a.checked,h=a.unchecked,m=a.__TYPE__,y=a.__DIFF__,g=a.passUtil,b=a.$defaultValue,w=a.$defaultState,S=a.$onFieldChange,C=a.$validators,P=a.$asyncValidators,F=a.$validateLazy,V=a.$memo,O=a.$reserveOnUnmount,k=a.$parser,_=a.$formatter,j=a.$ref,x=Dt(a,["name","type","defaultValue","valuePropName","changePropName","focusPropName","blurPropName","getValueFromEvent","validMessage","checked","unchecked","__TYPE__","__DIFF__","passUtil","$defaultValue","$defaultState","$onFieldChange","$validators","$asyncValidators","$validateLazy","$memo","$reserveOnUnmount","$parser","$formatter","$ref"]);var R={children:t,component:r,render:n};if(V===true&&it(y)){a.__DIFF__=[t,r,n]}var A=!it(o)||it(t)&&it(r)&&it(n);Object.keys(f(f({},a.$validators=f(f({},Fn),a.$validators)),a.$asyncValidators)).forEach((function(e){if(e in x){if(!A||!ht(e)){delete x[e]}}}));if(A){var D=(o||"").split("."),N=E(D,2),U=N[0],M=U===void 0?"text":U,T=N[1];R.component=M==="group"?gn:M==="list"?Cn:pn;if(i){x.name=i}if(o){x.type=M}if(t){x.children=t}x.checked=p;x.unchecked=h;switch(M){case"select":case"textarea":if(e.multiple){a[Pn]="array"}break;case"group":if(T==="checkbox"){a[Pn]="array"}x.type=T;break;case"checkbox":case"radio":a[Pn]="checked";break;case"list":a[Pn]="array";break}}if(!("$defaultValue"in a)&&"defaultValue"in e){a.$defaultValue=u}if(!("$defaultValue"in a)&&Pn in a){var I;switch(a[Pn]){case"checked":var L=a.unchecked,H=L===void 0?false:L;I=H;break;case"array":I=[];break;case"object":I={};break;case"number":I=0;break}a.$defaultValue=I}return{fieldProps:a,childProps:x,renderProps:R}}function _n(e,r){var n=r.component,a=r.render,i=r.children;if(n){return t.createElement(n,e)}if(ot(a)){return a(e)}if(ot(i)){return i(e)}return t.Children.map(i,(function(r){return t.cloneElement(r,e)}))}var jn=function(e){I(r,e);var t=K(r);function r(){var e;j(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++){a[i]=arguments[i]}e=t.call.apply(t,[this].concat(a));e.renderChildren=function(t){var r=e.parsedProps,n=r.fieldProps,a=r.childProps,i=r.renderProps;return _n(kn(t,n,a),i)};e.parsedProps={};return e}A(r,[{key:"render",value:function e(){var t=this.parsedProps=En(this.props),r=t.fieldProps;return a["default"].createElement(cn,Object.assign({},r,{children:this.renderChildren}))}}]);return r}(t.Component);jn.displayName=Vn;jn.defaultProps=On;function xn(e){var r=t.forwardRef((function(t,r){return a["default"].createElement(J.Consumer,null,(function(n){return a["default"].createElement(e,Object.assign({},t,{$formutil:n().$formutil,ref:r}))}))}));r.displayName="React.Formutil.connect."+(e.displayName||e.name||"Anonymous");return qr(r,e)}function Rn(){if(!a["default"].useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var e=a["default"].useContext;var t=e(J);return t()}function An(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!a["default"].useState){throw new Error("Hooks api need react@>=16.8, Please upgrade your reactjs.")}var r=a["default"].useState,n=a["default"].useLayoutEffect,i=a["default"].useEffect,o=a["default"].useRef;var u=typeof window==="undefined"?i:n;var s;if(e){if(typeof e==="string"){s=e;t.name=s}else{t=e;s=t.name}}var l=Rn();var c=o({}).current;var $=o([]);var d;c.$formContext=l;c.props=t;c.$setState=m;c.shouldRendered=true;var v=r((function(){c.$$FIELD_UUID=sn();c.$fieldHandler=d=ln(c);c.$fieldHandler.$$reset();c.$fieldHandler.$validate()})),p=E(v,2),h=p[1];if(!d){d=(l.$$registers||{})[c.$fieldHandler.$name]||c.$fieldHandler}u((function(){var e=c.$state;if(c.isMounting){if(!(s in(l.$$registers||{}))){d.$$triggerChange({$newValue:e.$value,$prevValue:c.$prevState.$value})}}c.$prevState=e}),[c.$state.$value]);u((function(){c.isMounting=true;W(!s||l.$formutil);return function(){c.isMounting=false;bt(t.$ref,null)}}),[]);u((function(){if(l.$$register){l.$$register(s,c.$fieldHandler)}return function(){if(l.$$unregister){l.$$unregister(s,c.$fieldHandler,!c.isMounting&&t.$reserveOnUnmount)}}}),[s]);u((function(){bt(t.$ref,c.$fieldutil)}));u((function(){if($.current.length>0){var e=w($.current);$.current.length=0;while(e.length){e.pop()(c.$fieldutil)}}}));function m(e,t){return new Promise((function(r){var n=function e(){return r(dt(t,c.$fieldutil))};if(c.isMounting){if(s in(l.$$registers||{})){c.shouldRendered=false;l.$$onChange(s,e,n);if(!c.shouldRendered){h({})}}else{d.$$merge(e);d.$$detectChange(e);h({});$.current.push(n)}}else{d.$$merge(e);n()}}))}return c.$fieldutil=f(f(f({$name:s},d.$getState()),d),{},{$$formutil:l.$formutil})}function Dn(){var e=Rn(),t=e.$formutil;return t}function Nn(e){e=f(f(f({},On),e),{},{children:null});var t=En(e),r=t.fieldProps,n=t.childProps;var a=An(r);return kn(a,r,n)}e.EasyField=jn;e.Field=cn;e.Form=jt;e.connect=xn;e.formContext=J;e.useField=An;e.useForm=Dn;e.useHandler=Nn;e.withField=vn;e.withForm=Yr;Object.defineProperty(e,"__esModule",{value:true})}));
